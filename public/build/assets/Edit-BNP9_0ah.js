import{r as S,N as ee,E as ne,d as X,K as O,_ as ie,L as A,g as ae,m as te,b as se,i as v,V as ce,ab as le,C as re,ag as oe,l as de,an as he,$ as me,j as i,Q as ue,B as D,h as H,s as P}from"./app-mk9C7I_N.js";import{A as ge,e as pe}from"./AdminLayout-CSpn-5iP.js";import{F as j}from"./index-ByQ52J4c.js";import{C as _}from"./index-DZTYDYFc.js";import{R as N,C as k}from"./row-CPFUowx7.js";import{T as Se}from"./index-DDFZ7dy0.js";import{R as xe}from"./ArrowLeftOutlined-cOBH5Dj-.js";import{I as R}from"./index-BiMKBPmP.js";import{a as K}from"./index-phC_QXgK.js";import{A as L}from"./index-B_QApcet.js";import{C as B}from"./Collapse-CcqPY5fy.js";import{a as W}from"./index-Bl_0AmJC.js";import{S as F}from"./index-pKRxIKW4.js";import{D as Ce}from"./index-DDZo9mtM.js";import{R as $e}from"./SaveOutlined-odoOer7R.js";import"./UserOutlined-Do6ZzMFA.js";import"./index-D66KGu5D.js";import"./EllipsisOutlined-DwAdn_jY.js";import"./PurePanel-Bwrv9FGC.js";import"./InboxOutlined-CDGQXwno.js";import"./useVariants-BUy45nvZ.js";import"./EditOutlined-CkdCVUZ6.js";import"./getAllowClear-BGHWSs2V.js";import"./CheckOutlined-CeCjh9xi.js";import"./Input-DUxd1TpC.js";import"./EyeOutlined-CQ17cMyg.js";import"./SearchOutlined-jGh7iI3q.js";var fe=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],Q=S.forwardRef(function(e,n){var c,s=e.prefixCls,l=s===void 0?"rc-switch":s,d=e.className,m=e.checked,a=e.defaultChecked,t=e.disabled,r=e.loadingIcon,g=e.checkedChildren,x=e.unCheckedChildren,y=e.onClick,$=e.onChange,h=e.onKeyDown,u=ee(e,fe),o=K(!1,{value:m,defaultValue:a}),p=ne(o,2),b=p[0],I=p[1];function M(C,E){var w=b;return t||(w=C,I(w),$==null||$(w,E)),w}function z(C){C.which===A.LEFT?M(!1,C):C.which===A.RIGHT&&M(!0,C),h==null||h(C)}function f(C){var E=M(!b,C);y==null||y(E,C)}var q=X(l,d,(c={},O(c,"".concat(l,"-checked"),b),O(c,"".concat(l,"-disabled"),t),c));return S.createElement("button",ie({},u,{type:"button",role:"switch","aria-checked":b,disabled:t,className:q,ref:n,onKeyDown:z,onClick:f}),r,S.createElement("span",{className:"".concat(l,"-inner")},S.createElement("span",{className:"".concat(l,"-inner-checked")},g),S.createElement("span",{className:"".concat(l,"-inner-unchecked")},x)))});Q.displayName="Switch";const be=e=>{const{componentCls:n,trackHeightSM:c,trackPadding:s,trackMinWidthSM:l,innerMinMarginSM:d,innerMaxMarginSM:m,handleSizeSM:a,calc:t}=e,r=`${n}-inner`,g=v(t(a).add(t(s).mul(2)).equal()),x=v(t(m).mul(2).equal());return{[n]:{[`&${n}-small`]:{minWidth:l,height:c,lineHeight:v(c),[`${n}-inner`]:{paddingInlineStart:m,paddingInlineEnd:d,[`${r}-checked, ${r}-unchecked`]:{minHeight:c},[`${r}-checked`]:{marginInlineStart:`calc(-100% + ${g} - ${x})`,marginInlineEnd:`calc(100% - ${g} + ${x})`},[`${r}-unchecked`]:{marginTop:t(c).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${n}-handle`]:{width:a,height:a},[`${n}-loading-icon`]:{top:t(t(a).sub(e.switchLoadingIconSize)).div(2).equal(),fontSize:e.switchLoadingIconSize},[`&${n}-checked`]:{[`${n}-inner`]:{paddingInlineStart:d,paddingInlineEnd:m,[`${r}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${r}-unchecked`]:{marginInlineStart:`calc(100% - ${g} + ${x})`,marginInlineEnd:`calc(-100% + ${g} - ${x})`}},[`${n}-handle`]:{insetInlineStart:`calc(100% - ${v(t(a).add(s).equal())})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${r}`]:{[`${r}-unchecked`]:{marginInlineStart:t(e.marginXXS).div(2).equal(),marginInlineEnd:t(e.marginXXS).mul(-1).div(2).equal()}},[`&${n}-checked ${r}`]:{[`${r}-checked`]:{marginInlineStart:t(e.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:t(e.marginXXS).div(2).equal()}}}}}}},Ie=e=>{const{componentCls:n,handleSize:c,calc:s}=e;return{[n]:{[`${n}-loading-icon${e.iconCls}`]:{position:"relative",top:s(s(c).sub(e.fontSize)).div(2).equal(),color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${n}-checked ${n}-loading-icon`]:{color:e.switchColor}}}},ve=e=>{const{componentCls:n,trackPadding:c,handleBg:s,handleShadow:l,handleSize:d,calc:m}=e,a=`${n}-handle`;return{[n]:{[a]:{position:"absolute",top:c,insetInlineStart:c,width:d,height:d,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:s,borderRadius:m(d).div(2).equal(),boxShadow:l,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${n}-checked ${a}`]:{insetInlineStart:`calc(100% - ${v(m(d).add(c).equal())})`},[`&:not(${n}-disabled):active`]:{[`${a}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${n}-checked ${a}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}}}},ye=e=>{const{componentCls:n,trackHeight:c,trackPadding:s,innerMinMargin:l,innerMaxMargin:d,handleSize:m,calc:a}=e,t=`${n}-inner`,r=v(a(m).add(a(s).mul(2)).equal()),g=v(a(d).mul(2).equal());return{[n]:{[t]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:d,paddingInlineEnd:l,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${t}-checked, ${t}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:c},[`${t}-checked`]:{marginInlineStart:`calc(-100% + ${r} - ${g})`,marginInlineEnd:`calc(100% - ${r} + ${g})`},[`${t}-unchecked`]:{marginTop:a(c).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${n}-checked ${t}`]:{paddingInlineStart:l,paddingInlineEnd:d,[`${t}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${t}-unchecked`]:{marginInlineStart:`calc(100% - ${r} + ${g})`,marginInlineEnd:`calc(-100% + ${r} - ${g})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${t}`]:{[`${t}-unchecked`]:{marginInlineStart:a(s).mul(2).equal(),marginInlineEnd:a(s).mul(-1).mul(2).equal()}},[`&${n}-checked ${t}`]:{[`${t}-checked`]:{marginInlineStart:a(s).mul(-1).mul(2).equal(),marginInlineEnd:a(s).mul(2).equal()}}}}}},we=e=>{const{componentCls:n,trackHeight:c,trackMinWidth:s}=e;return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},se(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:s,height:c,lineHeight:v(c),verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${n}-disabled)`]:{background:e.colorTextTertiary}}),ce(e)),{[`&${n}-checked`]:{background:e.switchColor,[`&:hover:not(${n}-disabled)`]:{background:e.colorPrimaryHover}},[`&${n}-loading, &${n}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${n}-rtl`]:{direction:"rtl"}})}},je=e=>{const{fontSize:n,lineHeight:c,controlHeight:s,colorWhite:l}=e,d=n*c,m=s/2,a=2,t=d-a*2,r=m-a*2;return{trackHeight:d,trackHeightSM:m,trackMinWidth:t*2+a*4,trackMinWidthSM:r*2+a*2,trackPadding:a,handleBg:l,handleSize:t,handleSizeSM:r,handleShadow:`0 2px 4px 0 ${new le("#00230b").setA(.2).toRgbString()}`,innerMinMargin:t/2,innerMaxMargin:t+a+a*2,innerMinMarginSM:r/2,innerMaxMarginSM:r+a+a*2}},ke=ae("Switch",e=>{const n=te(e,{switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchLoadingIconSize:e.calc(e.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[we(n),ye(n),ve(n),Ie(n),be(n)]},je);var Me=function(e,n){var c={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(c[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(e);l<s.length;l++)n.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(e,s[l])&&(c[s[l]]=e[s[l]]);return c};const Ee=S.forwardRef((e,n)=>{const{prefixCls:c,size:s,disabled:l,loading:d,className:m,rootClassName:a,style:t,checked:r,value:g,defaultChecked:x,defaultValue:y,onChange:$}=e,h=Me(e,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[u,o]=K(!1,{value:r??g,defaultValue:x??y}),{getPrefixCls:p,direction:b,switch:I}=S.useContext(re),M=S.useContext(oe),z=(l??M)||d,f=p("switch",c),q=S.createElement("div",{className:`${f}-handle`},d&&S.createElement(me,{className:`${f}-loading-icon`})),[C,E,w]=ke(f),U=de(s),J=X(I==null?void 0:I.className,{[`${f}-small`]:U==="small",[`${f}-loading`]:d,[`${f}-rtl`]:b==="rtl"},m,a,E,w),Y=Object.assign(Object.assign({},I==null?void 0:I.style),t),Z=(...T)=>{o(T[0]),$==null||$.apply(void 0,T)};return C(S.createElement(he,{component:"Switch"},S.createElement(Q,Object.assign({},h,{checked:u,onChange:Z,prefixCls:f,className:J,style:Y,disabled:z,ref:n,loadingIcon:q}))))}),G=Ee;G.__ANT_SWITCH=!0;const{Title:Ne,Text:V}=Se,{TextArea:ze}=R,{Panel:qe}=B;function ln({role:e,permissions:n,rolePermissionIds:c}){const[s]=j.useForm(),[l,d]=S.useState(!1),[m,a]=S.useState(c||[]),t=async h=>{d(!0);try{const u={...h,permissions:m};H.put(route("roles.update",e.id),u,{onSuccess:()=>{P.success("Role updated successfully")},onError:o=>{P.error("Please check the form for errors")},onFinish:()=>d(!1)})}catch{P.error("Failed to update role"),d(!1)}},r=(h,u)=>{const o=h.map(p=>p.id);a(u?p=>[...new Set([...p,...o])]:p=>p.filter(b=>!o.includes(b)))},g=(h,u)=>{a(u?o=>[...o,h]:o=>o.filter(p=>p!==h))},x=h=>h.every(u=>m.includes(u.id)),y=h=>h.some(u=>m.includes(u.id))&&!x(h),$=h=>({dashboard:"ផ្ទាំងគ្រប់គ្រង",buyers:"គ្រប់គ្រងអ្នកទិញ",sellers:"គ្រប់គ្រងអ្នកលក់",lands:"គ្រប់គ្រងដី",deposit_contracts:"លិខិតកក់ប្រាក់",sale_contracts:"លិខិតទិញលក់",reports:"របាយការណ៍",pre_purchase_commission:"កុំស្យុងមុនទិញ",post_purchase_commission:"កុំស្យុងក្រោយទិញ",users:"គ្រប់គ្រងអ្នកប្រើប្រាស់",roles:"គ្រប់គ្រងតួនាទី",permissions:"គ្រប់គ្រងសិទ្ធិ"})[h]||h.replace("_"," ").replace(/\b\w/g,o=>o.toUpperCase());return i.jsxs(ge,{title:"Edit Role",children:[i.jsx(ue,{title:`Edit Role - ${e.display_name}`}),i.jsxs(_,{children:[i.jsx("div",{className:"mb-6",children:i.jsxs(N,{justify:"space-between",align:"middle",children:[i.jsx(k,{children:i.jsxs(Ne,{level:4,className:"m-0",children:["កែប្រែតួនាទី: ",e.display_name]})}),i.jsx(k,{children:i.jsx(D,{icon:i.jsx(xe,{}),onClick:()=>H.visit(route("roles.index")),children:"ត្រលប់ទៅតួនាទី"})})]})}),i.jsxs(j,{form:s,layout:"vertical",onFinish:t,initialValues:{name:e.name,display_name:e.display_name,description:e.description,is_active:e.is_active},requiredMark:!1,children:[i.jsxs(N,{gutter:24,children:[i.jsx(k,{xs:24,lg:12,children:i.jsxs(_,{title:"ព័ត៌មានមូលដ្ឋាន",size:"small",children:[i.jsx(j.Item,{label:"ឈ្មោះតួនាទី",name:"name",rules:[{required:!0,message:"សូមបញ្ចូលឈ្មោះតួនាទី"},{max:255,message:"ឈ្មោះតួនាទីត្រូវតែតិចជាង 255 តួអក្សរ"}],children:i.jsx(R,{placeholder:"ឧ: manager, staff, viewer"})}),i.jsx(j.Item,{label:"ឈ្មោះបង្ហាញ",name:"display_name",rules:[{required:!0,message:"សូមបញ្ចូលឈ្មោះបង្ហាញ"},{max:255,message:"ឈ្មោះបង្ហាញត្រូវតែតិចជាង 255 តួអក្សរ"}],children:i.jsx(R,{placeholder:"ឧ: អ្នកគ្រប់គ្រង, បុគ្គលិក, អ្នកមើល"})}),i.jsx(j.Item,{label:"ការពិពណ៌នា",name:"description",children:i.jsx(ze,{rows:4,placeholder:"ពិពណ៌នាអំពីតួនាទី និងការទទួលខុសត្រូវ..."})}),i.jsx(j.Item,{label:"ស្ថានភាព",name:"is_active",valuePropName:"checked",children:i.jsx(G,{checkedChildren:"សកម្ម",unCheckedChildren:"អសកម្ម"})}),e.users_count>0&&i.jsx(L,{message:`តួនាទីនេះត្រូវបានកំណត់ឱ្យអ្នកប្រើប្រាស់ ${e.users_count} នាក់`,description:"ការផ្លាស់ប្តូរសិទ្ធិនឹងប៉ះពាល់ដល់អ្នកប្រើប្រាស់ទាំងអស់ដែលមានតួនាទីនេះ។",type:"warning",showIcon:!0})]})}),i.jsx(k,{xs:24,lg:12,children:i.jsxs(_,{title:i.jsxs(F,{children:[i.jsx(pe,{}),i.jsxs("span",{children:["សិទ្ធិ (",m.length," បានជ្រើសរើស)"]})]}),size:"small",children:[i.jsx(L,{message:"ជ្រើសរើសសិទ្ធិដែលតួនាទីនេះគួរមាន",description:"អ្នកប្រើប្រាស់ដែលត្រូវបានកំណត់ឱ្យតួនាទីនេះនឹងទទួលបានសិទ្ធិទាំងនេះ។",type:"info",showIcon:!0,className:"mb-4"}),i.jsx(B,{size:"small",ghost:!0,children:Object.entries(n||{}).map(([h,u])=>i.jsx(qe,{header:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(W,{checked:x(u),indeterminate:y(u),onChange:o=>r(u,o.target.checked),onClick:o=>o.stopPropagation(),children:i.jsx(V,{strong:!0,children:$(h)})}),i.jsxs(V,{type:"secondary",children:[u.filter(o=>m.includes(o.id)).length,"/",u.length]})]}),children:i.jsx("div",{className:"pl-6",children:i.jsx(N,{gutter:[16,8],children:u.map(o=>i.jsx(k,{xs:24,sm:12,children:i.jsx(W,{checked:m.includes(o.id),onChange:p=>g(o.id,p.target.checked),children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:o.display_name}),o.description&&i.jsx("div",{className:"text-xs text-gray-500",children:o.description})]})})},o.id))})})},h))})]})})]}),i.jsx(Ce,{}),i.jsx(N,{justify:"end",children:i.jsx(k,{children:i.jsxs(F,{children:[i.jsx(D,{onClick:()=>H.visit(route("roles.index")),children:"បោះបង់"}),i.jsx(D,{type:"primary",htmlType:"submit",loading:l,icon:i.jsx($e,{}),children:"កែប្រែតួនាទី"})]})})})]})]})]})}export{ln as default};
