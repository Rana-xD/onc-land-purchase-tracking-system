const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-BRuw9EN3.js","assets/app-BU2MgI_H.css"])))=>i.map(i=>d[i]);
import{r as g,I as p,_ as v,bH as w}from"./app-BRuw9EN3.js";import{h as y,E as P}from"./jspdf.es.min-CU8NuCx6.js";var E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"},D=function(f,a){return g.createElement(p,v({},f,{ref:a,icon:E}))},C=g.forwardRef(D);const L=()=>{const l=async(a,m,d={})=>{try{const e=document.getElementById(a);if(!e)throw new Error(`Element with ID "${a}" not found`);const r={...{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",width:e.scrollWidth,height:e.scrollHeight},...d.canvas},o=await y(e,r),t=210,c=295,n=o.height*t/o.width;let s=n;const i=new P("p","mm","a4");let u=0;for(i.addImage(o.toDataURL("image/png"),"PNG",0,u,t,n),s-=c;s>=0;)u=s-n,i.addPage(),i.addImage(o.toDataURL("image/png"),"PNG",0,u,t,n),s-=c;return i.save(m),{success:!0}}catch(e){return console.error("HTML to PDF generation failed:",e),{success:!1,error:e.message}}};return{generatePDFFromHTML:l,generatePDFFromComponent:async(a,m,d={})=>{try{const e=document.createElement("div");e.id="temp-pdf-container",e.style.position="absolute",e.style.left="-9999px",e.style.top="0",e.style.width="210mm",e.style.backgroundColor="#ffffff";const r=(await w(()=>import("./app-BRuw9EN3.js").then(o=>o.c),__vite__mapDeps([0,1]))).createRoot(e);return document.body.appendChild(e),new Promise(o=>{r.render(a),setTimeout(async()=>{try{const t=document.getElementById("temp-pdf-container");t&&t.calculatePageBreaks&&(t.calculatePageBreaks(),await new Promise(n=>setTimeout(n,500)));const c=await l("temp-pdf-container",m,d);t&&t.setPageBreaks&&t.setPageBreaks({}),r.unmount(),document.body.removeChild(e),o(c)}catch(t){r.unmount(),document.body.contains(e)&&document.body.removeChild(e),o({success:!1,error:t.message})}},1e3)})}catch(e){return console.error("Component to PDF generation failed:",e),{success:!1,error:e.message}}}}};export{C as R,L as u};
