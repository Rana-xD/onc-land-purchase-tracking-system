import{r as a,a as w,j as r,Q as g,t as c}from"./app-C0Remzwy.js";import{A as C}from"./AdminLayout-6aB_fSHs.js";import{C as L}from"./index-Cfi4PyFn.js";import{T as S}from"./index-_bYnS0vO.js";import{S as m}from"./index-BC2OOC4T.js";import{I as b}from"./index-BgpcnuvQ.js";import{R as k}from"./SearchOutlined-Dji_xwpY.js";import{F as T}from"./Table-f_13r9sB.js";import{T as I}from"./index-DPCB1Teb.js";import{R as v}from"./EyeOutlined-6voGcLSB.js";import"./UserOutlined-9GEWtyEU.js";import"./index-DQID86bo.js";import"./index-BkeYX-_W.js";import"./EllipsisOutlined-BvAucnIs.js";import"./PurePanel-LERcE_NN.js";import"./InboxOutlined-C_72B7nY.js";import"./useVariants-WSvFAMWE.js";import"./EditOutlined-Kmrbx6Vn.js";import"./getAllowClear-Ch9so_13.js";import"./CheckOutlined-CBgC1XT7.js";import"./Input-Db4JReOf.js";import"./addEventListener-CtdSgQvb.js";import"./index-O-VEiTMD.js";import"./useIcons-DwOnc_7J.js";import"./DownOutlined-TtH06v5g.js";import"./index-Cs8PXHGs.js";import"./Pagination-Bju1z6pp.js";import"./index-wspRjdfS.js";import"./FileOutlined-Db19IYhn.js";import"./FolderOutlined-E4df3Q5l.js";const{Title:R}=S;function ie({initialContracts:n}){const[u,p]=a.useState(n||[]),[f,l]=a.useState(!1),[i,x]=a.useState("");a.useEffect(()=>{n||_()},[n]);const _=async()=>{l(!0);try{const e=await w.get("/api/contracts/report-list");p(e.data)}catch(e){console.error("បញ្ហាក្នុងការទាញកិច្ចសន្យា:",e)}finally{l(!1)}},h=e=>e?new Date(e).toLocaleDateString("km-KH",{year:"numeric",month:"long",day:"numeric"}):"",j=u.filter(e=>{if(!i)return!0;const t=i.toLowerCase();return!!(e.document_code&&e.document_code.toLowerCase().includes(t)||e.id.toString().includes(t)||e.document_type&&e.document_type.toLowerCase().includes(t)||e.sellers&&e.sellers.some(o=>o.seller&&o.seller.name&&o.seller.name.toLowerCase().includes(t))||e.lands&&e.lands.some(o=>o.land&&o.land.plot_number&&o.land.plot_number.toLowerCase().includes(t)||o.land&&o.land.location&&o.land.location.toLowerCase().includes(t)))}),y=[{title:"លេខកិច្ចសន្យា",dataIndex:"document_code",key:"document_code",render:(e,t)=>r.jsx(c,{href:d(t),children:r.jsx("span",{className:"text-blue-600 hover:text-blue-800 cursor-pointer",children:e||`#${t.id}`})}),sorter:(e,t)=>e.document_code&&t.document_code?e.document_code.localeCompare(t.document_code):e.id-t.id},{title:"ប្រភេទកិច្ចសន្យា",dataIndex:"document_type",key:"document_type",render:e=>r.jsx(I,{color:e==="deposit_contract"?"blue":"green",children:e==="deposit_contract"?"កិច្ចសន្យាកក់ប្រាក់":"កិច្ចសន្យាលក់ដី"})},{title:"ឈ្មោះអ្នកលក់",key:"sellers",render:(e,t)=>r.jsx("span",{children:t.sellers&&t.sellers.length>0?t.sellers.map(o=>{var s;return(s=o.seller)==null?void 0:s.name}).filter(Boolean).join(", "):"N/A"})},{title:"លេខដីកម្មសិទ្ធិ",key:"lands",render:(e,t)=>r.jsx("span",{children:t.lands&&t.lands.length>0?t.lands.map(o=>{var s;return(s=o.land)==null?void 0:s.plot_number}).filter(Boolean).join(", "):"N/A"})},{title:"តម្លៃសរុប",dataIndex:"total_land_price",key:"total_land_price",render:e=>`$${parseFloat(e||0).toLocaleString()}`,sorter:(e,t)=>(e.total_land_price||0)-(t.total_land_price||0)},{title:"កាលបរិច្ឆេទបង្កើត",dataIndex:"created_at",key:"created_at",render:e=>h(e),sorter:(e,t)=>new Date(e.created_at)-new Date(t.created_at)},{title:"សកម្មភាព",key:"action",render:(e,t)=>r.jsx(m,{size:"small",children:r.jsx(c,{href:d(t),children:r.jsx(v,{className:"text-blue-600 hover:text-blue-800 cursor-pointer"})})})}],d=e=>e.document_type==="deposit_contract"?route("deposit-contracts.success",{id:e.id}):route("sale-contracts.success",{id:e.id});return r.jsxs(C,{children:[r.jsx(g,{title:"របាយការណ៍កិច្ចសន្យា"}),r.jsx("div",{className:"container mx-auto py-6",children:r.jsxs(L,{children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx(R,{level:3,children:"របាយការណ៍កិច្ចសន្យា"}),r.jsx(m,{children:r.jsx(b,{placeholder:"ស្វែងរកកិច្ចសន្យា...",prefix:r.jsx(k,{}),value:i,onChange:e=>x(e.target.value),style:{width:250}})})]}),r.jsx(T,{rowKey:"id",columns:y,dataSource:j,loading:f,pagination:{pageSize:15,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} នៃ ${e} កិច្ចសន្យា`}})]})})]})}export{ie as default};
