import{r as f,j as e,Q as T,S as m}from"./app-D0OhDuOP.js";import{A,e as M}from"./AdminLayout-DfyZC7U7.js";import{F as a}from"./index-01QrSur2.js";import{C as p}from"./index-BXZQm44E.js";import{R as c,C as l}from"./row-Cvvd4www.js";import{T as D}from"./index-DUD5X347.js";import{B as h}from"./index-XQ9uBlxv.js";import{R as q}from"./ArrowLeftOutlined-DaEIyD4l.js";import{I as j}from"./index-DyIYvMCA.js";import{A as z}from"./index-Ctm2Ggmv.js";import{C as b}from"./Collapse-B282zXVZ.js";import{C as g}from"./index-CxyNWzZ_.js";import{S as y}from"./index-CpY42lHj.js";import{D as E}from"./index-BoUcoXbW.js";import{R as B}from"./SaveOutlined-D-cLyBdL.js";import{s as x}from"./index-VXrvBi_7.js";import"./UserOutlined-Bw1Yg3TV.js";import"./index-BKPGZTnh.js";import"./EllipsisOutlined-BcUT9_x5.js";import"./PurePanel-BrlMViLC.js";import"./CheckOutlined-C-W3vkf9.js";import"./ExclamationCircleFilled-BuCwC-hN.js";import"./CloseOutlined-CSg-7HVH.js";import"./Skeleton-BB1PfEPR.js";import"./useVariants-VmmnPvRy.js";import"./index-BNYa27A7.js";import"./EditOutlined-BQAB7wjt.js";import"./getAllowClear-7r21EHJH.js";import"./Input-DIi4XD1o.js";import"./pickAttrs-BMtZpb9Y.js";import"./EyeOutlined-Bk9sN1n5.js";import"./SearchOutlined-DdbS1Qlk.js";import"./InfoCircleFilled-Csbq1HVY.js";import"./useBubbleLock-Dp5g0NxF.js";const{Title:L,Text:C}=D,{TextArea:P}=j,{Panel:Q}=b;function ve({permissions:v}){const[S]=a.useForm(),[R,d]=f.useState(!1),[o,n]=f.useState([]),N=async t=>{d(!0);try{const r={...t,permissions:o};m.post(route("roles.store"),r,{onSuccess:()=>{x.success("Role created successfully")},onError:s=>{x.error("Please check the form for errors")},onFinish:()=>d(!1)})}catch{x.error("Failed to create role"),d(!1)}},k=(t,r)=>{const s=t.map(i=>i.id);n(r?i=>[...new Set([...i,...s])]:i=>i.filter(F=>!s.includes(F)))},w=(t,r)=>{n(r?s=>[...s,t]:s=>s.filter(i=>i!==t))},u=t=>t.every(r=>o.includes(r.id)),I=t=>t.some(r=>o.includes(r.id))&&!u(t),_=t=>({dashboard:"ផ្ទាំងគ្រប់គ្រង",buyers:"គ្រប់គ្រងអ្នកទិញ",sellers:"គ្រប់គ្រងអ្នកលក់",lands:"គ្រប់គ្រងដី",deposit_contracts:"លិខិតកក់ប្រាក់",sale_contracts:"លិខិតទិញលក់",reports:"របាយការណ៍",pre_purchase_commission:"កម៉ីសិនមុនទិញ",post_purchase_commission:"កម៉ីសិនក្រោយទិញ",users:"គ្រប់គ្រងអ្នកប្រើប្រាស់",roles:"គ្រប់គ្រងតួនាទី",permissions:"គ្រប់គ្រងសិទ្ធិ"})[t]||t.replace("_"," ").replace(/\b\w/g,s=>s.toUpperCase());return e.jsxs(A,{title:"Create New Role",children:[e.jsx(T,{title:"Create Role"}),e.jsxs(p,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs(c,{justify:"space-between",align:"middle",children:[e.jsx(l,{children:e.jsx(L,{level:4,className:"m-0",children:"បង្កើតតួនាទីថ្មី"})}),e.jsx(l,{children:e.jsx(h,{icon:e.jsx(q,{}),onClick:()=>m.visit(route("roles.index")),children:"ត្រលប់ទៅតួនាទី"})})]})}),e.jsxs(a,{form:S,layout:"vertical",onFinish:N,requiredMark:!1,children:[e.jsxs(c,{gutter:24,children:[e.jsx(l,{xs:24,lg:12,children:e.jsxs(p,{title:"ព័ត៌មានមូលដ្ឋាន",size:"small",children:[e.jsx(a.Item,{label:"ឈ្មោះតួនាទី",name:"name",rules:[{required:!0,message:"សូមបញ្ចូលឈ្មោះតួនាទី"},{max:255,message:"ឈ្មោះតួនាទីត្រូវតែតិចជាង 255 តួអក្សរ"}],children:e.jsx(j,{placeholder:"ឧ: manager, staff, viewer"})}),e.jsx(a.Item,{label:"ឈ្មោះបង្ហាញ",name:"display_name",rules:[{required:!0,message:"សូមបញ្ចូលឈ្មោះបង្ហាញ"},{max:255,message:"ឈ្មោះបង្ហាញត្រូវតែតិចជាង 255 តួអក្សរ"}],children:e.jsx(j,{placeholder:"ឧ: អ្នកគ្រប់គ្រង, បុគ្គលិក, អ្នកមើល"})}),e.jsx(a.Item,{label:"ការពិពណ៌នា",name:"description",children:e.jsx(P,{rows:4,placeholder:"ពិពណ៌នាអំពីតួនាទី និងការទទួលខុសត្រូវ..."})})]})}),e.jsx(l,{xs:24,lg:12,children:e.jsxs(p,{title:e.jsxs(y,{children:[e.jsx(M,{}),e.jsxs("span",{children:["សិទ្ធិ (",o.length," បានជ្រើសរើស)"]})]}),size:"small",children:[e.jsx(z,{message:"ជ្រើសរើសសិទ្ធិដែលតួនាទីនេះគួរមាន",description:"អ្នកប្រើប្រាស់ដែលត្រូវបានកំណត់ឱ្យតួនាទីនេះនឹងទទួលបានសិទ្ធិទាំងនេះ។",type:"info",showIcon:!0,className:"mb-4"}),e.jsx(b,{size:"small",ghost:!0,children:Object.entries(v||{}).map(([t,r])=>e.jsx(Q,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{checked:u(r),indeterminate:I(r),onChange:s=>k(r,s.target.checked),onClick:s=>s.stopPropagation(),children:e.jsx(C,{strong:!0,children:_(t)})}),e.jsxs(C,{type:"secondary",children:[r.filter(s=>o.includes(s.id)).length,"/",r.length]})]}),children:e.jsx("div",{className:"pl-6",children:e.jsx(c,{gutter:[16,8],children:r.map(s=>e.jsx(l,{xs:24,sm:12,children:e.jsx(g,{checked:o.includes(s.id),onChange:i=>w(s.id,i.target.checked),children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.display_name}),s.description&&e.jsx("div",{className:"text-xs text-gray-500",children:s.description})]})})},s.id))})})},t))})]})})]}),e.jsx(E,{}),e.jsx(c,{justify:"end",children:e.jsx(l,{children:e.jsxs(y,{children:[e.jsx(h,{onClick:()=>m.visit(route("roles.index")),children:"បោះបង់"}),e.jsx(h,{type:"primary",htmlType:"submit",loading:R,icon:e.jsx(B,{}),children:"បង្កើតតួនាទី"})]})})})]})]})]})}export{ve as default};
