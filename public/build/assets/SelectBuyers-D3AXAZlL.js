import{r as m,j as e,Q as $,B as f,s as h,a as j}from"./app-Cq9T9vxM.js";import{n as a}from"./numberUtils-DuaFS_6b.js";import{A as z,b as B}from"./AdminLayout-CqQNNgQt.js";import{C as y}from"./index-0lybEGve.js";import{S as C}from"./index-DplbXNQy.js";import{T as E}from"./index-B236O7Xl.js";import{B as T}from"./index-DbhdeYUq.js";import{I as F}from"./index-DHD7yk2W.js";import{R as A}from"./SearchOutlined-PK94XR1x.js";import{F as L}from"./Table-BtVi7rN6.js";import{R as P}from"./UserOutlined-BJz0bsFe.js";import{R as Q}from"./EnvironmentOutlined-CY7V_ekf.js";import{R as b}from"./DollarOutlined-CBIm1o3u.js";import{R as D}from"./FileOutlined-azBO8rMn.js";import"./index-DL0uTJIv.js";import"./index-DPFVXnL-.js";import"./EllipsisOutlined-BDh9HHBq.js";import"./PurePanel-Ce8hDmce.js";import"./index-B5_NNnDd.js";import"./InboxOutlined-ZSWvT0kT.js";import"./useVariants-Ea3XEG1D.js";import"./CheckOutlined-_L7buK6x.js";import"./progress-CdXVhW7a.js";import"./EditOutlined-BcDUZ6EU.js";import"./getAllowClear-nqy4kNbo.js";import"./Input-DONKCjvs.js";import"./EyeOutlined-CFXJhbVH.js";import"./addEventListener-DU-bjus0.js";import"./index-B3veqm8A.js";import"./useIcons-Ds0_kiqE.js";import"./DownOutlined-8JSIA4HI.js";import"./index-DAepUo0f.js";import"./Pagination-DlQ44rBm.js";import"./index-C_zCuArI.js";import"./FolderOutlined-BXGz-0ra.js";const{Title:K,Text:Z}=E;function ve({buyers:g,selectedBuyers:w,documentType:o,editMode:p,documentId:c}){const[R,d]=m.useState(!1),[r,u]=m.useState(w||[]),[l,S]=m.useState(""),v=g.filter(t=>{if(!l)return!0;const s=a(l),i=a(t.name),x=a(t.identity_number),k=a(t.phone_number);return i.includes(s)||x.includes(s)||k.includes(s)}),I=[{title:"ជ្រើសរើស",dataIndex:"id",key:"selection",render:t=>e.jsx("input",{type:"checkbox",checked:r.includes(t),onChange:s=>{s.target.checked?u([...r,t]):u(r.filter(i=>i!==t))}})},{title:"ឈ្មោះ",dataIndex:"name",key:"name"},{title:"លេខអត្តសញ្ញាណប័ណ្ណ",dataIndex:"identity_number",key:"identity_number"},{title:"លេខទូរស័ព្ទ",dataIndex:"phone_number",key:"phone_number"}],N=async()=>{if(r.length===0){h.error("សូមជ្រើសរើសយ៉ាងហោចណាស់មួយ");return}d(!0);try{const t=o==="deposit_contract"?"deposit-contracts":"sale-contracts";let s=c;if(p&&c)s=c;else{const i=`/api/${t}/create`;s=(await j.post(i,{document_type:o})).data.id}await j.post(`/api/${t}/${s}/select-buyers`,{buyer_ids:r}),o==="deposit_contract"?window.location.href=route("deposit-contracts.select-sellers",{id:s}):window.location.href=route("sale-contracts.select-sellers",{id:s})}catch(t){console.error("Error creating document or selecting buyers:",t),h.error("មានបញ្ហាក្នុងការជ្រើសរើសអ្នកទិញ")}finally{d(!1)}},_=0,n=[{title:"ជ្រើសរើសអ្នកទិញ",icon:e.jsx(P,{})},{title:"ជ្រើសរើសអ្នកលក់",icon:e.jsx(B,{})},{title:"ជ្រើសរើសដី និងកំណត់តម្លៃ",icon:e.jsx(Q,{})}];return o==="deposit_contract"?n.push({title:"កំណត់ការកក់ប្រាក់",icon:e.jsx(b,{})}):n.push({title:"ដំណាក់កាលបង់ប្រាក់",icon:e.jsx(b,{})}),n.push({title:"បង្កើតកិច្ចសន្យា",icon:e.jsx(D,{})}),e.jsxs(z,{children:[e.jsx($,{title:"ជ្រើសរើសអ្នកទិញ"}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx(y,{className:"mb-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx(C,{current:_,items:n,responsive:!0,className:"site-navigation-steps",size:"small"})})}),e.jsxs(y,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx(K,{level:3,children:p?"កែសម្រួលអ្នកទិញ":"ជ្រើសរើសអ្នកទិញ"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"mr-2",children:"បានជ្រើសរើស"}),e.jsx(T,{count:r.length,showZero:!0,style:{marginTop:"0"}})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx(F,{placeholder:"ស្វែងរកតាមឈ្មោះ លេខអត្តសញ្ញាណប័ណ្ណ ឬលេខទូរស័ព្ទ",prefix:e.jsx(A,{}),value:l,onChange:t=>S(t.target.value),style:{width:"100%"}})}),e.jsx(L,{rowKey:"id",columns:I,dataSource:v,pagination:{pageSize:10},rowClassName:t=>r.includes(t.id)?"bg-blue-50":""}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx(f,{href:o==="deposit_contract"?route("deposit-contracts.index"):route("sale-contracts.index"),children:"ត្រឡប់"}),e.jsx(f,{type:"primary",onClick:N,loading:R,disabled:r.length===0,children:"បន្ត"})]})]})]})]})}export{ve as default};
