import{r as n,j as e,Q as F,t as p,B as u,a as I,s as h,h as L}from"./app-C81v863Z.js";import{A as P}from"./AdminLayout-4hWCCW4J.js";import{B as v}from"./Breadcrumb-4NJyj_rA.js";import{C as A,R as Q}from"./index-Cq5Cojs-.js";import{R as K,C as w}from"./row-DVautw-w.js";import{T as M}from"./index-DVx3a9qR.js";import{S as z}from"./index-0iedL70p.js";import{I as O}from"./index-CfwryaAm.js";import{T as x}from"./index-BDtS0eMa.js";import{F as q}from"./Table-9Jun1Fn2.js";import{T as G}from"./index-oMLWggrR.js";import{R as H}from"./EditOutlined-Dt25MYJV.js";import{P as J}from"./index-DhmPHNZK.js";import{R as U}from"./DeleteOutlined-CEoMe9ec.js";import"./UserOutlined-Cs_VmhTJ.js";import"./index-hGIK_HDO.js";import"./EllipsisOutlined-Dgx-5LTE.js";import"./PurePanel-B9LZ7YRU.js";import"./InboxOutlined-NtB6O71W.js";import"./DownOutlined-Bis42zyM.js";import"./useVariants-DiVBn6uh.js";import"./getAllowClear-YBVvCZBt.js";import"./CheckOutlined-BtpNa_G2.js";import"./Input-BSKYPgzP.js";import"./EyeOutlined-B_Q_oTAq.js";import"./SearchOutlined-rZRKH8d_.js";import"./addEventListener-CGfbZz05.js";import"./index-CXKhVvIi.js";import"./useIcons-Bcyu7X2C.js";import"./index-Dyio-8w4.js";import"./useBubbleLock-g9XhDwJl.js";import"./index-BXobfGdR.js";import"./Pagination-CQl1u3Ip.js";import"./index-alDFd_10.js";import"./FileOutlined-CLduoszu.js";import"./FolderOutlined-D8jm1l7w.js";const{Title:V}=M;function W({buyers:s,pagination:i}){const[k,l]=n.useState(!1),[f,C]=n.useState(""),[R,c]=n.useState([]),[a,m]=n.useState({current:1,pageSize:10,total:0});n.useEffect(()=>{s&&c(s),i&&m({current:i.current_page,pageSize:i.per_page,total:i.total})},[s,i]);const $=t=>{C(t),d(1,a.pageSize,t)},B=t=>{d(t.current,t.pageSize,f)},d=async(t,r,N="")=>{var y,j,g,S,b,T,_;l(!0);try{const o=await I.get("/api/buyers",{params:{page:t,per_page:r,search:N}});c(((y=o.data)==null?void 0:y.data)||[]),m({current:((g=(j=o.data)==null?void 0:j.meta)==null?void 0:g.current_page)||t,pageSize:((b=(S=o.data)==null?void 0:S.meta)==null?void 0:b.per_page)||r,total:((_=(T=o.data)==null?void 0:T.meta)==null?void 0:_.total)||0})}catch(o){console.error("Error fetching buyers:",o),h.error("មានបញ្ហាក្នុងការទាញយកទិន្នន័យអ្នកទិញ"),c([]),m({current:t,pageSize:r,total:0})}finally{l(!1)}},E=async t=>{l(!0);try{await I.delete(`/api/buyers/${t}`),h.success("បានលុបទិន្នន័យអ្នកទិញដោយជោគជ័យ"),d(a.current,a.pageSize,f)}catch(r){console.error("Error deleting buyer:",r),h.error("មានបញ្ហាក្នុងការលុបទិន្នន័យអ្នកទិញ")}finally{l(!1)}},D=[{title:"ឈ្មោះ",dataIndex:"name",key:"name",render:(t,r)=>e.jsx(p,{href:route("data-entry.buyers.show",r.id),children:t})},{title:"ភេទ",dataIndex:"sex",key:"sex",render:t=>e.jsx(G,{color:t==="male"?"blue":"pink",children:t==="male"?"ប្រុស":"ស្រី"})},{title:"ថ្ងៃខែឆ្នាំកំណើត",dataIndex:"date_of_birth",key:"date_of_birth",render:t=>t?new Date(t).toISOString().split("T")[0]:""},{title:"លេខអត្តសញ្ញាណប័ណ្ណ",dataIndex:"identity_number",key:"identity_number"},{title:"លេខទូរស័ព្ទ",dataIndex:"phone_number",key:"phone_number"},{title:"សកម្មភាព",key:"action",render:(t,r)=>e.jsxs(z,{size:"small",children:[e.jsx(x,{title:"កែប្រែព័ត៌មានអ្នកទិញ",children:e.jsx(u,{type:"default",icon:e.jsx(H,{}),size:"small",onClick:()=>L.visit(route("data-entry.buyers.edit",r.id))})}),e.jsx(J,{title:"តើអ្នកពិតជាចង់លុបទិន្នន័យនេះមែនទេ?",onConfirm:()=>E(r.id),okText:"យល់ព្រម",cancelText:"បោះបង់",children:e.jsx(x,{title:"លុបព័ត៌មានអ្នកទិញ",children:e.jsx(u,{type:"default",danger:!0,icon:e.jsx(U,{}),size:"small"})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"បញ្ជីអ្នកទិញ"}),e.jsxs("div",{className:"buyers-list",children:[e.jsx(v,{items:[{title:e.jsx(p,{href:route("data-entry.index"),children:"ជ្រើសរើសប្រភេទទិន្នន័យ"})},{title:"បញ្ជីអ្នកទិញ"}],className:"mb-6"}),e.jsxs(A,{children:[e.jsxs(K,{justify:"space-between",align:"middle",className:"mb-4",children:[e.jsx(w,{children:e.jsx(V,{level:4,className:"khmer-heading m-0",children:"បញ្ជីអ្នកទិញ"})}),e.jsx(w,{children:e.jsxs(z,{size:"middle",align:"end",children:[e.jsx(O.Search,{placeholder:"ស្វែងរកតាមឈ្មោះ ឬលេខទូរស័ព្ទ",onSearch:$,style:{width:250},allowClear:!0}),e.jsx(p,{href:route("data-entry.buyers.create"),children:e.jsx(x,{title:"បន្ថែមអ្នកទិញថ្មី",children:e.jsx(u,{type:"primary",icon:e.jsx(Q,{}),children:"បន្ថែមថ្មី"})})})]})})]}),e.jsx(q,{columns:D,dataSource:R,rowKey:"id",loading:k,pagination:{current:a.current,pageSize:a.pageSize,total:a.total,showSizeChanger:!0,showTotal:(t,r)=>`${r[0]}-${r[1]} នៃ ${t} ធាតុ`},onChange:B})]})]})]})}W.layout=s=>e.jsx(P,{title:"បញ្ជីអ្នកទិញ",children:s});export{W as default};
