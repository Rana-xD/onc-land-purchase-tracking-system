import{r as n,j as e,Q as w,B as j,s as c,a as C}from"./app-BRuw9EN3.js";import{A as T,b as _}from"./AdminLayout-BQR47gOS.js";import{C as f}from"./index-D2zmwFIy.js";import{S as $}from"./index-8il4p3hw.js";import{T as I}from"./index-DK7c9CS7.js";import{D as v}from"./index-D9jw-8Cn.js";import{T as A}from"./index-CfAtN55d.js";import{S as m}from"./index-gMKDkKA7.js";import{I as M}from"./index-BpUxqbWL.js";import{R as P}from"./UserOutlined-qdJtpBqh.js";import{R as E}from"./EnvironmentOutlined-7EJqH89h.js";import{R as L}from"./DollarOutlined-BrwFTWzR.js";import{R as k}from"./FileOutlined-B_lud-B5.js";import"./index-DjUyA9od.js";import"./index-E_hMYPT7.js";import"./EllipsisOutlined-CdogJ6km.js";import"./PurePanel-eBpBMAv8.js";import"./index-Bf8sDkQb.js";import"./InboxOutlined-CgVO651u.js";import"./useVariants-CDpFdPYi.js";import"./CheckOutlined-Du9YJw9D.js";import"./progress-DsA-Ejbg.js";import"./EditOutlined-LzavAjS2.js";import"./getAllowClear-3Rav48C8.js";import"./DownOutlined--KJm7Kio.js";import"./useIcons-DCGaULcT.js";import"./SearchOutlined-DTcydAAK.js";import"./Input-BgU6f7sv.js";import"./EyeOutlined-TX0XAQgo.js";const{Title:z,Text:d}=I,{Option:t}=m;function he({document:i,editMode:y}){const[g,x]=n.useState(!1),[p,b]=n.useState(i.deposit_amount||0),[r,h]=n.useState(i.deposit_months||3),[o,N]=n.useState("preset"),[a,u]=n.useState(""),S=async()=>{if(!p){c.error("សូមបញ្ចូលចំនួនប្រាក់កក់");return}let s=r;if(o==="custom"){if(!a||a.trim()===""){c.error("សូមបញ្ចូលរយៈពេល");return}s=a}else if(r)r===.25?s="1 សប្តាហ៍":r===.5?s="2 សប្តាហ៍":r===.75?s="3 សប្តាហ៍":r===1?s="4 សប្តាហ៍":s=`${r} ខែ`;else{c.error("សូមជ្រើសរើសរយៈពេលកក់ប្រាក់");return}x(!0);try{await C.post(`/api/deposit-contracts/${i.id}/deposit-config`,{deposit_amount:p,deposit_months:s,custom_days:o==="custom"?a:null}),window.location.href=route("deposit-contracts.success",{id:i.id})}catch(l){console.error("Error generating document:",l),l.response&&l.response.data&&l.response.data.error?c.error(l.response.data.error):c.error("មានបញ្ហាក្នុងការបង្កើតកិច្ចសន្យា")}finally{x(!1)}},D=3,R=[{title:"ជ្រើសរើសអ្នកទិញ",icon:e.jsx(P,{})},{title:"ជ្រើសរើសអ្នកលក់",icon:e.jsx(_,{})},{title:"ជ្រើសរើសដី និងកំណត់តម្លៃ",icon:e.jsx(E,{})},{title:"កំណត់ការកក់ប្រាក់",icon:e.jsx(L,{})},{title:"បង្កើតកិច្ចសន្យា",icon:e.jsx(k,{})}];return e.jsxs(T,{children:[e.jsx(w,{title:"កំណត់ការកក់ប្រាក់"}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx(f,{className:"mb-6",children:e.jsx($,{current:D,items:R,responsive:!0,className:"site-navigation-steps",size:"small"})}),e.jsxs(f,{children:[e.jsx(z,{level:3,className:"mb-6",children:y?"កែសម្រួលការកក់ប្រាក់":"កំណត់ការកក់ប្រាក់"}),e.jsx("div",{className:"mb-6",children:e.jsxs(d,{strong:!0,children:["តម្លៃដីសរុប: $",parseFloat(i.total_land_price).toLocaleString()]})}),e.jsx(v,{}),e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(d,{strong:!0,children:["ចំនួនប្រាក់កក់ (Deposit Amount)"," ",e.jsx("span",{style:{color:"red"},children:"*"})]})}),e.jsx(A,{style:{width:"100%"},min:0,max:i.total_land_price,precision:2,prefix:"$",value:p,onChange:b,placeholder:"បញ្ចូលចំនួនប្រាក់កក់"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(d,{strong:!0,children:["រយៈពេលកក់ប្រាក់ (Deposit Period)"," ",e.jsx("span",{style:{color:"red"},children:"*"})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs(m,{style:{width:"100%"},value:o,onChange:s=>{N(s),s==="preset"?u(""):h(null)},placeholder:"ជ្រើសរើសប្រភេទរយៈពេល",children:[e.jsx(t,{value:"preset",children:"ជ្រើសរើសពីជម្រើសដែលមាន"}),e.jsx(t,{value:"custom",children:"បញ្ចូលដោយខ្លួនឯង"})]})}),o==="preset"&&e.jsxs(m,{style:{width:"100%"},value:r,onChange:h,placeholder:"ជ្រើសរើសរយៈពេល",children:[e.jsx(t,{value:.25,children:"1 សប្តាហ៍"}),e.jsx(t,{value:.5,children:"2 សប្តាហ៍"}),e.jsx(t,{value:.75,children:"3 សប្តាហ៍"}),e.jsx(t,{value:1,children:"4 សប្តាហ៍"}),e.jsx(t,{value:2,children:"2 ខែ"}),e.jsx(t,{value:3,children:"3 ខែ"}),e.jsx(t,{value:4,children:"4 ខែ"}),e.jsx(t,{value:5,children:"5 ខែ"}),e.jsx(t,{value:6,children:"6 ខែ"})]}),o==="custom"&&e.jsxs("div",{children:[e.jsx(M,{style:{width:"100%"},value:a,onChange:s=>u(s.target.value),placeholder:"បញ្ចូលរយៈពេល (ឧ. 20 ថ្ងៃ, 45 ថ្ងៃ)"}),e.jsx(d,{type:"secondary",style:{fontSize:"12px",display:"block",marginTop:"4px"},children:"ឧទាហរណ៍: 20 ថ្ងៃ, 2 សប្តាហ៍, 1.5 ខែ"})]})]})]}),e.jsx(v,{}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx(j,{href:route("deposit-contracts.select-lands",{id:i.id}),children:"ត្រឡប់"}),e.jsx(j,{type:"primary",onClick:S,loading:g,disabled:!p||o==="preset"&&!r||o==="custom"&&(!a||a.trim()===""),children:"បង្កើតកិច្ចសន្យា"})]})]})]})]})}export{he as default};
