import{J as C,r as c,j as t,Q as I,B as x,s,h as S}from"./app-BRuw9EN3.js";import{R,A as k}from"./AdminLayout-BQR47gOS.js";import{B as F}from"./BuyerForm-Db3DkaDB.js";import{F as w,B as A}from"./BackImageUpload-BmrLhrVk.js";import{B as v}from"./Breadcrumb-B8YoZBHX.js";import{C as E}from"./index-D2zmwFIy.js";import{S as N}from"./index-8il4p3hw.js";import{R as D,C as y}from"./row-BdHN0AJ4.js";import{R as L}from"./ArrowLeftOutlined-D_uUsJ9A.js";import{R as M}from"./ArrowRightOutlined-Em3Pl8_p.js";import"./UserOutlined-qdJtpBqh.js";import"./index-DjUyA9od.js";import"./index-E_hMYPT7.js";import"./EllipsisOutlined-CdogJ6km.js";import"./PurePanel-eBpBMAv8.js";import"./index-Bf8sDkQb.js";import"./InboxOutlined-CgVO651u.js";import"./dayjs.min-Bxd_QX6p.js";import"./khmerDate-iNtMyZoL.js";import"./index-Bo-QlqYD.js";import"./index-BpUxqbWL.js";import"./getAllowClear-3Rav48C8.js";import"./Input-BgU6f7sv.js";import"./useVariants-CDpFdPYi.js";import"./EyeOutlined-TX0XAQgo.js";import"./SearchOutlined-DTcydAAK.js";import"./EditOutlined-LzavAjS2.js";import"./index-gMKDkKA7.js";import"./useIcons-DCGaULcT.js";import"./CheckOutlined-Du9YJw9D.js";import"./DownOutlined--KJm7Kio.js";import"./index-DBuduWnf.js";import"./CalendarOutlined-CHKAy2k-.js";import"./ClockCircleOutlined-glwEvsx3.js";import"./index-CHJwRL4J.js";import"./addEventListener-Dx0K44fe.js";import"./FileImageOutlined-dU_6WOeV.js";import"./index-DK7c9CS7.js";import"./index-emLlVOqM.js";import"./DeleteOutlined-D1uBv-mg.js";import"./index-ZnRvTRfi.js";import"./DownloadOutlined-AcKWlS-z.js";import"./progress-DsA-Ejbg.js";import"./index-CnESk_LV.js";import"./index-BXqabLx5.js";import"./UploadOutlined-D29I9h76.js";function Q(){const{props:f}=C(),[r,d]=c.useState(0),[i,g]=c.useState(null),[a,h]=c.useState(null),[U,l]=c.useState(!1),n=[{title:"រូបខាងមុខ",content:"front-image"},{title:"រូបខាងក្រោយ",content:"back-image"},{title:"បញ្ចូលព័ត៌មាន",content:"buyer-info"}],j=()=>{if(r===0){if(!i){s.error("សូមផ្ទុកឡើងរូបខាងមុខ");return}}else if(r===1&&!a){s.error("សូមផ្ទុកឡើងរូបខាងក្រោយ");return}d(r+1)},b=()=>{d(r-1)},B=async u=>{l(!0);try{const o=[];i&&o.push({...i,isDisplay:!0,type:"front"}),a&&o.push({...a,isDisplay:!1,type:"back"});const e={...u,files:o};console.log("Submitting buyer data:",e);const p=await window.axios.post("/api/buyers",e,{headers:{"Content-Type":"application/json",Accept:"application/json"}});(p.status===200||p.status===201)&&(l(!1),S.visit(route("data-entry.buyers.index"),{onSuccess:()=>{s.success("អ្នកទិញត្រូវបានបង្កើតដោយជោគជ័យ")}}))}catch(o){if(l(!1),console.error("Error creating buyer:",o),o.response&&o.response.data){const e=o.response.data;e.errors?Object.keys(e.errors).forEach(m=>{const p=Array.isArray(e.errors[m])?e.errors[m][0]:e.errors[m];s.error(p)}):e.message?s.error(e.message):s.error("មានបញ្ហាក្នុងការបង្កើតអ្នកទិញ")}else s.error("មានបញ្ហាក្នុងការបង្កើតអ្នកទិញ")}};return t.jsxs(t.Fragment,{children:[t.jsx(I,{title:"បញ្ចូលព័ត៌មានអ្នកទិញថ្មី"}),t.jsx(v,{className:"mb-6",items:[{href:route("dashboard"),title:t.jsx(R,{})},{href:route("data-entry.index"),title:"ទិន្នន័យបញ្ចូល"},{href:route("data-entry.buyers.index"),title:"បញ្ជីអ្នកទិញ"},{title:"បញ្ចូលព័ត៌មានអ្នកទិញថ្មី"}]}),t.jsxs(E,{children:[t.jsx(N,{current:r,items:n.map(u=>({title:u.title})),className:"mb-8"}),t.jsxs("div",{className:"steps-content mb-8",children:[n[r].content==="front-image"&&t.jsx(w,{category:"buyer",frontImage:i,onFrontImageChange:g}),n[r].content==="back-image"&&t.jsx(A,{category:"buyer",backImage:a,onBackImageChange:h}),n[r].content==="buyer-info"&&t.jsx(F,{onSubmit:B,files:[i,a].filter(Boolean),frontImage:i})]}),t.jsx("div",{className:"steps-action",children:t.jsxs(D,{justify:"space-between",children:[t.jsx(y,{children:r>0&&t.jsx(x,{icon:t.jsx(L,{}),onClick:b,children:"ត្រឡប់ក្រោយ"})}),t.jsx(y,{children:r<n.length-1&&t.jsx(x,{type:"primary",onClick:j,icon:t.jsx(M,{}),iconPosition:"end",children:r===0?"បន្តទៅរូបខាងក្រោយ":"បន្ទាប់"})})]})})]})]})}Q.layout=f=>t.jsx(k,{children:f,title:"បញ្ចូលព័ត៌មានអ្នកទិញថ្មី"});export{Q as default};
