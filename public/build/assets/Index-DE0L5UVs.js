import{r as l,j as e,Q as B,t as c,B as r,e as m,s as o}from"./app-BBTICp4j.js";import{A as D}from"./AdminLayout-DxDDGS0e.js";import{C as E,R as A}from"./index-B2wIyAm9.js";import{R as y,C as i}from"./row-Dtoexlvv.js";import{T as Q}from"./index-Cfh7qGRB.js";import{I as L}from"./index-COa_6DPI.js";import{R}from"./SearchOutlined-DJlkhe1H.js";import{S}from"./index-mLV1oJws.js";import{S as g}from"./index-BLi1CBmm.js";import{R as M}from"./ReloadOutlined-58Wmi41X.js";import{F as Y}from"./Table-BNh4n8r6.js";import{B as J}from"./index-DqwI38n1.js";import{R as K}from"./UserOutlined-B9ZAOThG.js";import{T as O}from"./index-BNp8CWBR.js";import{R as v}from"./CheckCircleOutlined-ThKSjgvJ.js";import{R as T}from"./StopOutlined-p3kG5cVu.js";import{T as n}from"./index-C5oWf6N6.js";import{R as V}from"./EyeOutlined-Dift8YHl.js";import{R as Z}from"./EditOutlined-DhdXE3k2.js";import{P as w}from"./index-B5Vkae57.js";import{R as q}from"./DeleteOutlined--CfOCEP9.js";import"./index-D88NIlOR.js";import"./EllipsisOutlined-Bhf9hnSZ.js";import"./PurePanel-DnHFRN3c.js";import"./useVariants-Bsn3ZCEZ.js";import"./getAllowClear-DLCbMek5.js";import"./CheckOutlined-DMU6mItx.js";import"./Input-BDTvmsS1.js";import"./useIcons-DLppMF82.js";import"./DownOutlined-CIxjOa2g.js";import"./addEventListener-ungWzbhy.js";import"./index-BTHh_Gpg.js";import"./useBubbleLock-ClpRCOWH.js";import"./index-AFDIk0Sd.js";import"./Pagination-CRn34H2T.js";import"./index-CcJgjeQ-.js";import"./FileOutlined-Bkjwbk_U.js";import"./FolderOutlined-BtKR_-vO.js";const{Title:G}=Q,{Option:I}=S;function Pe({roles:$}){const[C,_]=l.useState($||[]),[k,d]=l.useState(!1),[x,p]=l.useState(""),[h,u]=l.useState(null),a=async(t={})=>{d(!0);try{const s=await m.get("/api/roles",{params:{search:x,status:h,...t}});_(s.data.data||s.data)}catch{o.error("Failed to fetch roles")}finally{d(!1)}},z=async t=>{var s,f;try{await m.delete(`/api/roles/${t}`),o.success("Role deleted successfully"),a()}catch(P){o.error(((f=(s=P.response)==null?void 0:s.data)==null?void 0:f.message)||"Failed to delete role")}},N=async t=>{try{await m.post(`/api/roles/${t}/toggle-status`),o.success("Role status updated successfully"),a()}catch{o.error("Failed to update role status")}},j=()=>{a()},b=()=>{p(""),u(null),a()},F=[{title:"ឈ្មោះតួនាទី",dataIndex:"display_name",key:"display_name",render:(t,s)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t}),e.jsxs("div",{className:"text-gray-500 text-sm",children:["(",s.name,")"]})]})},{title:"ការពិពណ៌នា",dataIndex:"description",key:"description",render:t=>t||"-"},{title:"អ្នកប្រើប្រាស់",dataIndex:"users_count",key:"users_count",render:t=>e.jsx(J,{count:t||0,showZero:!0,children:e.jsx(K,{style:{fontSize:"16px"}})})},{title:"ស្ថានភាព",dataIndex:"is_active",key:"is_active",render:t=>e.jsx(O,{icon:t?e.jsx(v,{}):e.jsx(T,{}),color:t?"success":"error",children:t?"សកម្ម":"អសកម្ម"})},{title:"សកម្មភាព",key:"actions",render:(t,s)=>e.jsxs(g,{size:"small",children:[e.jsx(n,{title:"View Details",children:e.jsx(c,{href:route("roles.show",s.id),children:e.jsx(r,{type:"text",icon:e.jsx(V,{}),size:"small"})})}),e.jsx(n,{title:"Edit Role",children:e.jsx(c,{href:route("roles.edit",s.id),children:e.jsx(r,{type:"text",icon:e.jsx(Z,{}),size:"small"})})}),e.jsx(n,{title:s.is_active?"Deactivate":"Activate",children:e.jsx(w,{title:`Are you sure you want to ${s.is_active?"deactivate":"activate"} this role?`,onConfirm:()=>N(s.id),okText:"Yes",cancelText:"No",children:e.jsx(r,{type:"text",icon:s.is_active?e.jsx(T,{}):e.jsx(v,{}),size:"small",danger:s.is_active})})}),e.jsx(n,{title:"Delete Role",children:e.jsx(w,{title:"Are you sure you want to delete this role?",description:"This action cannot be undone.",onConfirm:()=>z(s.id),okText:"Yes",cancelText:"No",okType:"danger",children:e.jsx(r,{type:"text",icon:e.jsx(q,{}),size:"small",danger:!0,disabled:s.users_count>0})})})]})}];return e.jsxs(D,{title:"Role & Permission Management",children:[e.jsx(B,{title:"Roles & Permissions"}),e.jsxs(E,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(y,{justify:"space-between",align:"middle",className:"mb-4",children:[e.jsx(i,{children:e.jsx(G,{level:4,className:"m-0",children:"តួនាទី និង សិទ្ធិ"})}),e.jsx(i,{children:e.jsx(c,{href:route("roles.create"),children:e.jsx(r,{type:"primary",icon:e.jsx(A,{}),children:"បង្កើតតួនាទីថ្មី"})})})]}),e.jsxs(y,{gutter:16,className:"mb-4",children:[e.jsx(i,{xs:24,sm:12,md:8,children:e.jsx(L,{placeholder:"ស្វែងរកតួនាទី...",value:x,onChange:t=>p(t.target.value),onPressEnter:j,prefix:e.jsx(R,{})})}),e.jsx(i,{xs:24,sm:12,md:6,children:e.jsxs(S,{placeholder:"ត្រងតាមស្ថានភាព",value:h,onChange:u,allowClear:!0,style:{width:"100%"},children:[e.jsx(I,{value:!0,children:"សកម្ម"}),e.jsx(I,{value:!1,children:"អសកម្ម"})]})}),e.jsx(i,{xs:24,sm:24,md:10,children:e.jsxs(g,{children:[e.jsx(r,{type:"primary",icon:e.jsx(R,{}),onClick:j,children:"ស្វែងរក"}),e.jsx(r,{icon:e.jsx(M,{}),onClick:b,children:"កំណត់ឡើងវិញ"})]})})]})]}),e.jsx(Y,{columns:F,dataSource:C,rowKey:"id",loading:k,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} នៃ ${t} តួនាទី`},scroll:{x:800}})]})]})}export{Pe as default};
