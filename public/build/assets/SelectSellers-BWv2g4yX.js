import{r as l,j as e,Q as N,B as p,s as u,a as k}from"./app-C0Remzwy.js";import{n}from"./numberUtils-DuaFS_6b.js";import{A as T,b as z}from"./AdminLayout-6aB_fSHs.js";import{C as x}from"./index-Cfi4PyFn.js";import{S as C}from"./index-D8QTW78o.js";import{T as $}from"./index-_bYnS0vO.js";import{B}from"./index-N7wpmPjk.js";import{I as E}from"./index-BgpcnuvQ.js";import{R as F}from"./SearchOutlined-Dji_xwpY.js";import{F as A}from"./Table-f_13r9sB.js";import{R as L}from"./UserOutlined-9GEWtyEU.js";import{R as P}from"./EnvironmentOutlined-Dg-c_VSb.js";import{R as f}from"./DollarOutlined-DplF-jS5.js";import{R as Q}from"./FileOutlined-Db19IYhn.js";import"./index-DQID86bo.js";import"./index-BkeYX-_W.js";import"./EllipsisOutlined-BvAucnIs.js";import"./PurePanel-LERcE_NN.js";import"./index-BC2OOC4T.js";import"./InboxOutlined-C_72B7nY.js";import"./useVariants-WSvFAMWE.js";import"./CheckOutlined-CBgC1XT7.js";import"./progress-DpSHyWCv.js";import"./EditOutlined-Kmrbx6Vn.js";import"./getAllowClear-Ch9so_13.js";import"./Input-Db4JReOf.js";import"./EyeOutlined-6voGcLSB.js";import"./addEventListener-CtdSgQvb.js";import"./index-O-VEiTMD.js";import"./useIcons-DwOnc_7J.js";import"./DownOutlined-TtH06v5g.js";import"./index-Cs8PXHGs.js";import"./Pagination-Bju1z6pp.js";import"./index-wspRjdfS.js";import"./FolderOutlined-E4df3Q5l.js";const{Title:K,Text:M}=$;function we({document:s,sellers:h,selectedSellers:j,editMode:y}){const[b,m]=l.useState(!1),[r,d]=l.useState(j||[]),[a,g]=l.useState(""),_=h.filter(t=>{if(!a)return!0;const i=n(a),c=n(t.name),v=n(t.identity_number),R=n(t.phone_number);return c.includes(i)||v.includes(i)||R.includes(i)}),S=[{title:"ជ្រើសរើស",dataIndex:"id",key:"selection",render:t=>e.jsx("input",{type:"checkbox",checked:r.includes(t),onChange:i=>{i.target.checked?d([...r,t]):d(r.filter(c=>c!==t))}})},{title:"ឈ្មោះ",dataIndex:"name",key:"name"},{title:"លេខអត្តសញ្ញាណប័ណ្ណ",dataIndex:"identity_number",key:"identity_number"},{title:"លេខទូរស័ព្ទ",dataIndex:"phone_number",key:"phone_number"}],w=async()=>{if(r.length===0){u.error("សូមជ្រើសរើសយ៉ាងហោចណាស់មួយ");return}m(!0);try{const t=s.document_type==="deposit_contract"?"deposit-contracts":"sale-contracts";await k.post(`/api/${t}/${s.id}/select-sellers`,{seller_ids:r}),s.document_type==="deposit_contract"?window.location.href=route("deposit-contracts.select-lands",{id:s.id}):window.location.href=route("sale-contracts.select-lands",{id:s.id})}catch(t){console.error("Error selecting sellers:",t),u.error("មានបញ្ហាក្នុងការជ្រើសរើសអ្នកលក់")}finally{m(!1)}},I=1;s.document_type;const o=[{title:"ជ្រើសរើសអ្នកទិញ",icon:e.jsx(L,{})},{title:"ជ្រើសរើសអ្នកលក់",icon:e.jsx(z,{})},{title:"ជ្រើសរើសដី និងកំណត់តម្លៃ",icon:e.jsx(P,{})}];return s.document_type==="deposit_contract"?o.push({title:"កំណត់ការកក់ប្រាក់",icon:e.jsx(f,{})}):o.push({title:"ដំណាក់កាលបង់ប្រាក់",icon:e.jsx(f,{})}),o.push({title:"បង្កើតកិច្ចសន្យា",icon:e.jsx(Q,{})}),e.jsxs(T,{children:[e.jsx(N,{title:"ជ្រើសរើសអ្នកលក់"}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx(x,{className:"mb-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx(C,{current:I,items:o,responsive:!0,className:"site-navigation-steps",size:"small"})})}),e.jsxs(x,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx(K,{level:3,children:y?"កែសម្រួលអ្នកលក់":"ជ្រើសរើសអ្នកលក់"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"mr-2",children:"បានជ្រើសរើស"}),e.jsx(B,{count:r.length,showZero:!0,style:{marginTop:"0"}})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx(E,{placeholder:"ស្វែងរកតាមឈ្មោះ លេខអត្តសញ្ញាណប័ណ្ណ ឬលេខទូរស័ព្ទ",prefix:e.jsx(F,{}),value:a,onChange:t=>g(t.target.value),style:{width:"100%"}})}),e.jsx(A,{rowKey:"id",columns:S,dataSource:_,pagination:{pageSize:10},rowClassName:t=>r.includes(t.id)?"bg-blue-50":""}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx(p,{href:route(s.document_type==="deposit_contract"?"deposit-contracts.select-buyers":"sale-contracts.select-buyers",{id:s.id}),children:"ត្រឡប់"}),e.jsx(p,{type:"primary",onClick:w,loading:b,disabled:r.length===0,children:"បន្ត"})]})]})]})]})}export{we as default};
