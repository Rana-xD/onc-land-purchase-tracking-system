import{r as s,d as g,j as r,Q as w,t as i}from"./app-D0OhDuOP.js";import{A as b}from"./AdminLayout-DfyZC7U7.js";import{C as L,R as C}from"./index-BXZQm44E.js";import{T as I}from"./index-DUD5X347.js";import{S as d}from"./index-CpY42lHj.js";import{I as S}from"./index-DyIYvMCA.js";import{R as k}from"./SearchOutlined-DdbS1Qlk.js";import{B as l}from"./index-XQ9uBlxv.js";import{F as D}from"./Table-CJMywyvl.js";import{T as R}from"./index-DxlGwFBo.js";import{R as T}from"./EyeOutlined-Bk9sN1n5.js";import{R as v}from"./FilePdfOutlined-BmX1d_m5.js";import"./UserOutlined-Bw1Yg3TV.js";import"./index-BKPGZTnh.js";import"./EllipsisOutlined-BcUT9_x5.js";import"./PurePanel-BrlMViLC.js";import"./index-BoUcoXbW.js";import"./Skeleton-BB1PfEPR.js";import"./CloseOutlined-CSg-7HVH.js";import"./useVariants-VmmnPvRy.js";import"./EditOutlined-BQAB7wjt.js";import"./getAllowClear-7r21EHJH.js";import"./CheckOutlined-C-W3vkf9.js";import"./Input-DIi4XD1o.js";import"./pickAttrs-BMtZpb9Y.js";import"./addEventListener-Dvq9iQDE.js";import"./index-BXlDNFm_.js";import"./useIcons-De8HtjeC.js";import"./DownOutlined-BKT6hG3e.js";import"./index-CxyNWzZ_.js";import"./useBubbleLock-Dp5g0NxF.js";import"./index-HowiUfuo.js";import"./Pagination-C28t5-1k.js";import"./index-Bjcdw0HM.js";import"./extendsObject-78o_rR5W.js";import"./FileOutlined-CmtzEeI9.js";import"./FolderOutlined-CsvjmU0T.js";import"./useClosable-rmjEiMr1.js";const{Title:$}=I;function he({initialDocuments:a}){const[u,f]=s.useState(a||[]),[x,c]=s.useState(!1),[n,y]=s.useState("");s.useEffect(()=>{a||h()},[a]);const h=async()=>{c(!0);try{const e=await g.get("/api/documents");f(e.data)}catch(e){console.error("Error fetching documents:",e)}finally{c(!1)}},m=e=>e?new Date(e).toLocaleDateString("km-KH",{year:"numeric",month:"long",day:"numeric"}):"",p=e=>({label:e==="deposit_contract"?"លិខិតកក់ប្រាក់":"លិខិតទិញ លក់",color:e==="deposit_contract"?"blue":"green"}),j=u.filter(e=>{if(!n)return!0;const t=n.toLowerCase();return!!(e.id.toString().includes(t)||p(e.document_type).label.toLowerCase().includes(t)||e.created_at&&m(e.created_at).toLowerCase().includes(t)||e.buyers&&e.buyers.some(o=>o.name.toLowerCase().includes(t))||e.sellers&&e.sellers.some(o=>o.name.toLowerCase().includes(t))||e.lands&&e.lands.some(o=>o.plot_number.toLowerCase().includes(t)||o.location.toLowerCase().includes(t)))}),_=[{title:"លេខសម្គាល់",dataIndex:"id",key:"id",sorter:(e,t)=>e.id-t.id},{title:"ប្រភេទឯកសារ",dataIndex:"document_type",key:"document_type",render:e=>{const{label:t,color:o}=p(e);return r.jsx(R,{color:o,children:t})},filters:[{text:"លិខិតកក់ប្រាក់",value:"deposit_contract"},{text:"លិខិតទិញ លក់",value:"sale_contract"}],onFilter:(e,t)=>t.document_type===e},{title:"អ្នកទិញ",key:"buyers",render:(e,t)=>r.jsx("span",{children:t.buyers&&t.buyers.length>0?t.buyers.map(o=>o.name).join(", "):"N/A"})},{title:"អ្នកលក់",key:"sellers",render:(e,t)=>r.jsx("span",{children:t.sellers&&t.sellers.length>0?t.sellers.map(o=>o.name).join(", "):"N/A"})},{title:"តម្លៃដីសរុប",dataIndex:"total_land_price",key:"total_land_price",render:e=>`$${parseFloat(e).toLocaleString()}`,sorter:(e,t)=>e.total_land_price-t.total_land_price},{title:"កាលបរិច្ឆេទបង្កើត",dataIndex:"created_at",key:"created_at",render:e=>m(e),sorter:(e,t)=>new Date(e.created_at)-new Date(t.created_at)},{title:"សកម្មភាព",key:"action",render:(e,t)=>r.jsxs(d,{size:"small",children:[r.jsx(i,{href:route("documents.success",{id:t.id}),children:r.jsx(l,{type:"text",icon:r.jsx(T,{})})}),r.jsx(i,{href:`/documents/${t.id}/download`,target:"_blank",children:r.jsx(l,{type:"text",icon:r.jsx(v,{})})})]})}];return r.jsxs(b,{children:[r.jsx(w,{title:"បញ្ជីឯកសារ"}),r.jsx("div",{className:"container mx-auto py-6",children:r.jsxs(L,{children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx($,{level:3,children:"បញ្ជីឯកសារ"}),r.jsxs(d,{children:[r.jsx(S,{placeholder:"ស្វែងរក...",prefix:r.jsx(k,{}),value:n,onChange:e=>y(e.target.value),style:{width:200}}),r.jsx(i,{href:route("documents.index"),children:r.jsx(l,{type:"primary",icon:r.jsx(C,{}),children:"បង្កើតឯកសារថ្មី"})})]})]}),r.jsx(D,{rowKey:"id",columns:_,dataSource:j,loading:x,pagination:{pageSize:10}})]})})]})}export{he as default};
