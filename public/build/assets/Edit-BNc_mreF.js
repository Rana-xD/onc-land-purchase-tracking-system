import{r as m,j as t,Q as C,t as x,B as c,h as g,s as p,a as I}from"./app-BRuw9EN3.js";import{A as B}from"./AdminLayout-BQR47gOS.js";import{S as v}from"./SellerForm-BxVIpnZn.js";import{F as E,B as N}from"./BackImageUpload-BmrLhrVk.js";import{d as R}from"./dayjs.min-Bxd_QX6p.js";import{B as F}from"./Breadcrumb-B8YoZBHX.js";import{C as D}from"./index-D2zmwFIy.js";import{T}from"./index-DK7c9CS7.js";import{S as y}from"./index-8il4p3hw.js";import{R as $,C as j}from"./row-BdHN0AJ4.js";import{R as w}from"./ArrowLeftOutlined-D_uUsJ9A.js";import{S as A}from"./index-Bf8sDkQb.js";import{R as L}from"./ArrowRightOutlined-Em3Pl8_p.js";import"./UserOutlined-qdJtpBqh.js";import"./index-DjUyA9od.js";import"./index-E_hMYPT7.js";import"./EllipsisOutlined-CdogJ6km.js";import"./PurePanel-eBpBMAv8.js";import"./InboxOutlined-CgVO651u.js";import"./khmerDate-iNtMyZoL.js";import"./index-Bo-QlqYD.js";import"./index-BpUxqbWL.js";import"./getAllowClear-3Rav48C8.js";import"./Input-BgU6f7sv.js";import"./useVariants-CDpFdPYi.js";import"./EyeOutlined-TX0XAQgo.js";import"./SearchOutlined-DTcydAAK.js";import"./EditOutlined-LzavAjS2.js";import"./index-gMKDkKA7.js";import"./useIcons-DCGaULcT.js";import"./CheckOutlined-Du9YJw9D.js";import"./DownOutlined--KJm7Kio.js";import"./index-DBuduWnf.js";import"./CalendarOutlined-CHKAy2k-.js";import"./ClockCircleOutlined-glwEvsx3.js";import"./SaveOutlined-DDefvXT0.js";import"./index-CHJwRL4J.js";import"./addEventListener-Dx0K44fe.js";import"./index-emLlVOqM.js";import"./DeleteOutlined-D1uBv-mg.js";import"./FileImageOutlined-dU_6WOeV.js";import"./index-ZnRvTRfi.js";import"./DownloadOutlined-AcKWlS-z.js";import"./progress-DsA-Ejbg.js";import"./index-CnESk_LV.js";import"./index-BXqabLx5.js";import"./UploadOutlined-D29I9h76.js";const{Title:Q,Text:wt}=T,{Step:U}=y;function M({seller:r,documents:l}){const[i,f]=m.useState(0),[o,d]=m.useState(null),[a,u]=m.useState(null),[P,h]=m.useState(!1);m.useEffect(()=>{l&&l.length>0&&l.forEach(e=>{const s={uid:e.id,name:e.file_name,fileName:e.file_name,url:`/storage/${e.file_path}`,base64:`/storage/${e.file_path}`,isExisting:!0,id:e.id,isDisplay:e.is_display,mimeType:"image/jpeg"};e.is_display?d(s):u(s)})},[l]);const n=[{title:"រូបខាងមុខ",content:"front-image"},{title:"រូបខាងក្រោយ",content:"back-image"},{title:"បញ្ចូលព័ត៌មាន",content:"seller-info"}],b=()=>{if(i===0){if(!o){p.error("សូមផ្ទុកឡើងរូបខាងមុខ");return}}else if(i===1&&!a){p.error("សូមផ្ទុកឡើងរូបខាងក្រោយ");return}f(i+1)},S=()=>{f(i-1)},_=async e=>{h(!0);try{const s=[];o&&s.push({...o,isDisplay:!0,type:"front"}),a&&s.push({...a,isDisplay:!1,type:"back"});const k={...e,files:s};await I.put(`/api/sellers/${r.id}`,k),p.success("អ្នកលក់ត្រូវបានកែប្រែដោយជោគជ័យ"),g.visit(route("data-entry.sellers.index"))}catch(s){console.error("Error updating seller:",s),p.error("មានបញ្ហាក្នុងការកែប្រែអ្នកលក់")}finally{h(!1)}};return t.jsxs(t.Fragment,{children:[t.jsx(C,{title:"កែប្រែអ្នកលក់"}),t.jsxs("div",{className:"seller-edit",children:[t.jsx(F,{items:[{title:t.jsx(x,{href:route("data-entry.index"),children:"ជ្រើសរើសប្រភេទទិន្នន័យ"})},{title:t.jsx(x,{href:route("data-entry.sellers.index"),children:"បញ្ជីអ្នកលក់"})},{title:"កែប្រែអ្នកលក់"}],className:"mb-6"}),t.jsxs(D,{children:[t.jsx(Q,{level:4,className:"khmer-heading mb-6",children:"កែប្រែអ្នកលក់"}),t.jsx(y,{current:i,className:"mb-8",children:n.map(e=>t.jsx(U,{title:e.title,icon:e.icon},e.title))}),t.jsxs("div",{className:"steps-content mb-6",children:[n[i].content==="front-image"&&t.jsx(E,{category:"seller",frontImage:o,onFrontImageChange:d}),n[i].content==="back-image"&&t.jsx(N,{category:"seller",backImage:a,onBackImageChange:u}),n[i].content==="seller-info"&&t.jsx(v,{onSubmit:_,files:[o,a].filter(Boolean),frontImage:o,initialValues:{name:r.name,sex:r.sex,date_of_birth:r.date_of_birth?R(r.date_of_birth):null,identity_number:r.identity_number,address:r.address,phone_number:r.phone_number}})]}),t.jsx("div",{className:"steps-action",children:t.jsxs($,{justify:"space-between",children:[t.jsx(j,{children:i>0&&t.jsx(c,{icon:t.jsx(w,{}),onClick:S,children:"ត្រឡប់ក្រោយ"})}),t.jsx(j,{children:t.jsxs(A,{children:[t.jsx(c,{onClick:()=>g.visit(route("data-entry.sellers.index")),children:"បោះបង់"}),i<n.length-1&&t.jsx(c,{type:"primary",onClick:b,icon:t.jsx(L,{}),iconPosition:"end",children:i===0?"បន្តទៅរូបខាងក្រោយ":"បន្ទាប់"})]})})]})})]})]})]})}M.layout=r=>t.jsx(B,{title:"កែប្រែអ្នកលក់",children:r});export{M as default};
