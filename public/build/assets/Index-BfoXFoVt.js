import{r as l,j as e,Q as B,t as c,B as r,a as m,s as o}from"./app-BrCXGEhZ.js";import{A as D}from"./AdminLayout-sV_EEP8n.js";import{C as E,R as A}from"./index-DRz4vaHg.js";import{R as y,C as i}from"./row-stCrAj79.js";import{T as Q}from"./index-Dru69ujH.js";import{I as L}from"./index-qaS1-amX.js";import{R}from"./SearchOutlined-BDCl3y_A.js";import{S}from"./index-Ch5jzg5Q.js";import{S as g}from"./index-OVY5O9Wo.js";import{R as M}from"./ReloadOutlined-DyivhAg6.js";import{F as Y}from"./Table-J9C6Be-7.js";import{B as J}from"./index-DfVfnMMj.js";import{R as K}from"./UserOutlined-DgkU0Wia.js";import{T as O}from"./index-pzF3Y6wt.js";import{R as v}from"./CheckCircleOutlined-SjtlU7Oe.js";import{R as T}from"./StopOutlined-DjgCbz5g.js";import{T as n}from"./index-DXnJKA6M.js";import{R as V}from"./EyeOutlined-CG_zYn54.js";import{R as Z}from"./EditOutlined-tdLcT6_z.js";import{P as w}from"./index-C5of6ZWE.js";import{R as q}from"./DeleteOutlined-85Q0A1R5.js";import"./index-DjqfnhJJ.js";import"./EllipsisOutlined-CxDggLKs.js";import"./PurePanel-BBaic0YS.js";import"./InboxOutlined-Qxvmf9ye.js";import"./useVariants-EJywnfb4.js";import"./getAllowClear-CiWMq0gn.js";import"./CheckOutlined-BONIWw9W.js";import"./Input-BbbFc-8M.js";import"./useIcons-CR98POIW.js";import"./DownOutlined-Bc8ecrXM.js";import"./addEventListener-I1XHhjus.js";import"./index-D0979U_2.js";import"./useBubbleLock-CmR5-O3r.js";import"./index-Dib3LoS_.js";import"./Pagination-7ru7OaTS.js";import"./index-DwuA6IHU.js";import"./FileOutlined-DtqVzwrm.js";import"./FolderOutlined-sXfZ_WPD.js";const{Title:G}=Q,{Option:I}=S;function Be({roles:$}){const[C,_]=l.useState($||[]),[k,d]=l.useState(!1),[p,x]=l.useState(""),[h,u]=l.useState(null),a=async(t={})=>{d(!0);try{const s=await m.get("/api/roles",{params:{search:p,status:h,...t}});_(s.data.data||s.data)}catch{o.error("Failed to fetch roles")}finally{d(!1)}},z=async t=>{var s,f;try{await m.delete(`/api/roles/${t}`),o.success("Role deleted successfully"),a()}catch(P){o.error(((f=(s=P.response)==null?void 0:s.data)==null?void 0:f.message)||"Failed to delete role")}},N=async t=>{try{await m.post(`/api/roles/${t}/toggle-status`),o.success("Role status updated successfully"),a()}catch{o.error("Failed to update role status")}},j=()=>{a()},b=()=>{x(""),u(null),a()},F=[{title:"ឈ្មោះតួនាទី",dataIndex:"display_name",key:"display_name",render:(t,s)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t}),e.jsxs("div",{className:"text-gray-500 text-sm",children:["(",s.name,")"]})]})},{title:"ការពិពណ៌នា",dataIndex:"description",key:"description",render:t=>t||"-"},{title:"អ្នកប្រើប្រាស់",dataIndex:"users_count",key:"users_count",render:t=>e.jsx(J,{count:t||0,showZero:!0,children:e.jsx(K,{style:{fontSize:"16px"}})})},{title:"ស្ថានភាព",dataIndex:"is_active",key:"is_active",render:t=>e.jsx(O,{icon:t?e.jsx(v,{}):e.jsx(T,{}),color:t?"success":"error",children:t?"សកម្ម":"អសកម្ម"})},{title:"សកម្មភាព",key:"actions",render:(t,s)=>e.jsxs(g,{size:"small",children:[e.jsx(n,{title:"View Details",children:e.jsx(c,{href:route("roles.show",s.id),children:e.jsx(r,{type:"text",icon:e.jsx(V,{}),size:"small"})})}),e.jsx(n,{title:"Edit Role",children:e.jsx(c,{href:route("roles.edit",s.id),children:e.jsx(r,{type:"text",icon:e.jsx(Z,{}),size:"small"})})}),e.jsx(n,{title:s.is_active?"Deactivate":"Activate",children:e.jsx(w,{title:`Are you sure you want to ${s.is_active?"deactivate":"activate"} this role?`,onConfirm:()=>N(s.id),okText:"Yes",cancelText:"No",children:e.jsx(r,{type:"text",icon:s.is_active?e.jsx(T,{}):e.jsx(v,{}),size:"small",danger:s.is_active})})}),e.jsx(n,{title:"Delete Role",children:e.jsx(w,{title:"Are you sure you want to delete this role?",description:"This action cannot be undone.",onConfirm:()=>z(s.id),okText:"Yes",cancelText:"No",okType:"danger",children:e.jsx(r,{type:"text",icon:e.jsx(q,{}),size:"small",danger:!0,disabled:s.users_count>0})})})]})}];return e.jsxs(D,{title:"Role & Permission Management",children:[e.jsx(B,{title:"Roles & Permissions"}),e.jsxs(E,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(y,{justify:"space-between",align:"middle",className:"mb-4",children:[e.jsx(i,{children:e.jsx(G,{level:4,className:"m-0",children:"តួនាទី និង សិទ្ធិ"})}),e.jsx(i,{children:e.jsx(c,{href:route("roles.create"),children:e.jsx(r,{type:"primary",icon:e.jsx(A,{}),children:"បង្កើតតួនាទីថ្មី"})})})]}),e.jsxs(y,{gutter:16,className:"mb-4",children:[e.jsx(i,{xs:24,sm:12,md:8,children:e.jsx(L,{placeholder:"ស្វែងរកតួនាទី...",value:p,onChange:t=>x(t.target.value),onPressEnter:j,prefix:e.jsx(R,{})})}),e.jsx(i,{xs:24,sm:12,md:6,children:e.jsxs(S,{placeholder:"ត្រងតាមស្ថានភាព",value:h,onChange:u,allowClear:!0,style:{width:"100%"},children:[e.jsx(I,{value:!0,children:"សកម្ម"}),e.jsx(I,{value:!1,children:"អសកម្ម"})]})}),e.jsx(i,{xs:24,sm:24,md:10,children:e.jsxs(g,{children:[e.jsx(r,{type:"primary",icon:e.jsx(R,{}),onClick:j,children:"ស្វែងរក"}),e.jsx(r,{icon:e.jsx(M,{}),onClick:b,children:"កំណត់ឡើងវិញ"})]})})]})]}),e.jsx(Y,{columns:F,dataSource:C,rowKey:"id",loading:k,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} នៃ ${t} តួនាទី`},scroll:{x:800}})]})]})}export{Be as default};
