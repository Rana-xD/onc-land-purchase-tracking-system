import{J as C,r as c,j as t,Q as I,B as d,s,h as S}from"./app-Cq9T9vxM.js";import{R,A as k}from"./AdminLayout-CqQNNgQt.js";import{B as F}from"./BuyerForm-B6uHbJNT.js";import{F as w,B as A}from"./BackImageUpload-v8_ZFOT5.js";import{B as v}from"./Breadcrumb-6m4s_fwQ.js";import{C as E}from"./index-0lybEGve.js";import{S as N}from"./index-DplbXNQy.js";import{R as L,C as x}from"./row-CJ-aj50t.js";import{R as M}from"./ArrowLeftOutlined-y-0HxkNq.js";import{R as Q}from"./ArrowRightOutlined-CR7245gU.js";import"./UserOutlined-BJz0bsFe.js";import"./index-DL0uTJIv.js";import"./index-DPFVXnL-.js";import"./EllipsisOutlined-BDh9HHBq.js";import"./PurePanel-Ce8hDmce.js";import"./index-B5_NNnDd.js";import"./InboxOutlined-ZSWvT0kT.js";import"./dayjs.min-BTLK4jSO.js";import"./khmerDate-iNtMyZoL.js";import"./index-UraXu45p.js";import"./index-DHD7yk2W.js";import"./getAllowClear-nqy4kNbo.js";import"./Input-DONKCjvs.js";import"./useVariants-Ea3XEG1D.js";import"./EyeOutlined-CFXJhbVH.js";import"./SearchOutlined-PK94XR1x.js";import"./EditOutlined-BcDUZ6EU.js";import"./index-B3veqm8A.js";import"./useIcons-Ds0_kiqE.js";import"./CheckOutlined-_L7buK6x.js";import"./DownOutlined-8JSIA4HI.js";import"./index-CKm1mZ_X.js";import"./CalendarOutlined-CimjgQ7W.js";import"./ClockCircleOutlined-CuqZA4f1.js";import"./index-DmXmgjLE.js";import"./addEventListener-DU-bjus0.js";import"./FileImageOutlined-h47-aNI4.js";import"./index-B236O7Xl.js";import"./index-C_oXb-ri.js";import"./DeleteOutlined-j2tGMUPF.js";import"./index-Ut4Nl-5k.js";import"./DownloadOutlined-C0uSoOge.js";import"./progress-CdXVhW7a.js";import"./index-eUbAuevc.js";import"./index-C_zCuArI.js";import"./UploadOutlined-Dnm-KKHJ.js";function U(){const{props:u}=C(),[r,f]=c.useState(0),[a,g]=c.useState(null),[m,j]=c.useState(null),[$,p]=c.useState(!1),n=[{title:"រូបខាងមុខ",content:"front-image"},{title:"រូបខាងក្រោយ",content:"back-image"},{title:"បញ្ចូលព័ត៌មាន",content:"buyer-info"}],y=()=>{if(r===0){if(!a){s.error("សូមផ្ទុកឡើងរូបខាងមុខ");return}}else if(r===1&&!m){s.error("សូមផ្ទុកឡើងរូបខាងក្រោយ");return}f(r+1)},b=()=>{f(r-1)},h=async l=>{p(!0);try{const o={...l,frontImage:a,backImage:m};console.log("Submitting buyer data:",o);const i=await window.axios.post("/api/buyers",o,{headers:{"Content-Type":"application/json",Accept:"application/json"}});(i.status===200||i.status===201)&&(p(!1),S.visit(route("data-entry.buyers.index"),{onSuccess:()=>{s.success("អ្នកទិញត្រូវបានបង្កើតដោយជោគជ័យ")}}))}catch(o){if(p(!1),console.error("Error creating buyer:",o),o.response&&o.response.data){const e=o.response.data;e.errors?Object.keys(e.errors).forEach(i=>{const B=Array.isArray(e.errors[i])?e.errors[i][0]:e.errors[i];s.error(B)}):e.message?s.error(e.message):s.error("មានបញ្ហាក្នុងការបង្កើតអ្នកទិញ")}else s.error("មានបញ្ហាក្នុងការបង្កើតអ្នកទិញ")}};return t.jsxs(t.Fragment,{children:[t.jsx(I,{title:"បញ្ចូលព័ត៌មានអ្នកទិញថ្មី"}),t.jsx(v,{className:"mb-6",items:[{href:route("dashboard"),title:t.jsx(R,{})},{href:route("data-entry.index"),title:"ទិន្នន័យបញ្ចូល"},{href:route("data-entry.buyers.index"),title:"បញ្ជីអ្នកទិញ"},{title:"បញ្ចូលព័ត៌មានអ្នកទិញថ្មី"}]}),t.jsxs(E,{children:[t.jsx(N,{current:r,items:n.map(l=>({title:l.title})),className:"mb-8"}),t.jsxs("div",{className:"steps-content mb-8",children:[n[r].content==="front-image"&&t.jsx(w,{category:"buyer",frontImage:a,onFrontImageChange:g}),n[r].content==="back-image"&&t.jsx(A,{category:"buyer",backImage:m,onBackImageChange:j}),n[r].content==="buyer-info"&&t.jsx(F,{onSubmit:h,files:[a,m].filter(Boolean),frontImage:a})]}),t.jsx("div",{className:"steps-action",children:t.jsxs(L,{justify:"space-between",children:[t.jsx(x,{children:r>0&&t.jsx(d,{icon:t.jsx(M,{}),onClick:b,children:"ត្រឡប់ក្រោយ"})}),t.jsx(x,{children:r<n.length-1&&t.jsx(d,{type:"primary",onClick:y,icon:t.jsx(Q,{}),iconPosition:"end",children:r===0?"បន្តទៅរូបខាងក្រោយ":"បន្ទាប់"})})]})})]})]})}U.layout=u=>t.jsx(k,{children:u,title:"បញ្ចូលព័ត៌មានអ្នកទិញថ្មី"});export{U as default};
