import{r as m,j as e,Q as N,B as u,s as x,a as f}from"./app-zwF1qXmt.js";import{n as c}from"./numberUtils-DuaFS_6b.js";import{A as k,b as $}from"./AdminLayout-7EiKnzDi.js";import{C as h}from"./index-BViq9QJ5.js";import{S as z}from"./index-DaBWAD6m.js";import{T as C}from"./index-Bur7rjdX.js";import{B}from"./index-BTMXsAZS.js";import{I as E}from"./index-DnWjr1E0.js";import{R as T}from"./SearchOutlined-ckskIcIF.js";import{F}from"./Table-BOxY9eJ4.js";import{R as A}from"./UserOutlined-_tsZ_L2L.js";import{R as L}from"./EnvironmentOutlined-DfrbTZ4R.js";import{R as j}from"./DollarOutlined-CW2DtJ3s.js";import{R as P}from"./FileOutlined-Cr8DQwSN.js";import"./index-BwOrOVI4.js";import"./index-B73L-RiE.js";import"./EllipsisOutlined-BgCch_Wi.js";import"./PurePanel-BlgAcrce.js";import"./index-Dcqx-5CC.js";import"./InboxOutlined-C6Tl-Jce.js";import"./useVariants-DJWLAYkM.js";import"./CheckOutlined-CWbPYj3k.js";import"./progress-xMLXHtD_.js";import"./EditOutlined-DAqDAxHf.js";import"./getAllowClear-DSmRZVga.js";import"./Input-BkgYjX8b.js";import"./EyeOutlined-DlB_godP.js";import"./addEventListener-VTVT0Xmn.js";import"./index-CseKHSuS.js";import"./useIcons-DF0NetuM.js";import"./DownOutlined-CAWJwJ4J.js";import"./index-DZvpsH_A.js";import"./useBubbleLock-Be9_HeRQ.js";import"./index-c65RzQeC.js";import"./Pagination-a66s3alc.js";import"./index-lwJ32dcB.js";import"./FolderOutlined-D2Qk_bz3.js";const{Title:Q,Text:K}=C;function Se({buyers:y,selectedBuyers:b,documentType:o}){const[g,d]=m.useState(!1),[s,p]=m.useState(b||[]),[l,w]=m.useState(""),I=y.filter(t=>{if(!l)return!0;const r=c(l),a=c(t.name),i=c(t.identity_number),_=c(t.phone_number);return a.includes(r)||i.includes(r)||_.includes(r)}),R=[{title:"ជ្រើសរើស",dataIndex:"id",key:"selection",render:t=>e.jsx("input",{type:"checkbox",checked:s.includes(t),onChange:r=>{r.target.checked?p([...s,t]):p(s.filter(a=>a!==t))}})},{title:"ឈ្មោះ",dataIndex:"name",key:"name"},{title:"លេខអត្តសញ្ញាណប័ណ្ណ",dataIndex:"identity_number",key:"identity_number"},{title:"លេខទូរស័ព្ទ",dataIndex:"phone_number",key:"phone_number"}],S=async()=>{if(s.length===0){x.error("សូមជ្រើសរើសយ៉ាងហោចណាស់មួយ");return}d(!0);try{const t=o==="deposit_contract"?"deposit-contracts":"sale-contracts",r=`/api/${t}/create`,i=(await f.post(r,{document_type:o})).data.id;await f.post(`/api/${t}/${i}/select-buyers`,{buyer_ids:s}),o==="deposit_contract"?window.location.href=route("deposit-contracts.select-sellers",{id:i}):window.location.href=route("sale-contracts.select-sellers",{id:i})}catch(t){console.error("Error creating document or selecting buyers:",t),x.error("មានបញ្ហាក្នុងការជ្រើសរើសអ្នកទិញ")}finally{d(!1)}},v=0,n=[{title:"ជ្រើសរើសអ្នកទិញ",icon:e.jsx(A,{})},{title:"ជ្រើសរើសអ្នកលក់",icon:e.jsx($,{})},{title:"ជ្រើសរើសដី និងកំណត់តម្លៃ",icon:e.jsx(L,{})}];return o==="deposit_contract"?n.push({title:"កំណត់ការកក់ប្រាក់",icon:e.jsx(j,{})}):n.push({title:"ដំណាក់កាលបង់ប្រាក់",icon:e.jsx(j,{})}),n.push({title:"បង្កើតកិច្ចសន្យា",icon:e.jsx(P,{})}),e.jsxs(k,{children:[e.jsx(N,{title:"ជ្រើសរើសអ្នកទិញ"}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx(h,{className:"mb-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx(z,{current:v,items:n,responsive:!0,className:"site-navigation-steps",size:"small"})})}),e.jsxs(h,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx(Q,{level:3,children:"ជ្រើសរើសអ្នកទិញ"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"mr-2",children:"បានជ្រើសរើស"}),e.jsx(B,{count:s.length,showZero:!0,style:{marginTop:"0"}})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx(E,{placeholder:"ស្វែងរកតាមឈ្មោះ លេខអត្តសញ្ញាណប័ណ្ណ ឬលេខទូរស័ព្ទ",prefix:e.jsx(T,{}),value:l,onChange:t=>w(t.target.value),style:{width:"100%"}})}),e.jsx(F,{rowKey:"id",columns:R,dataSource:I,pagination:{pageSize:10},rowClassName:t=>s.includes(t.id)?"bg-blue-50":""}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx(u,{href:o==="deposit_contract"?route("deposit-contracts.index"):route("sale-contracts.index"),children:"ត្រឡប់"}),e.jsx(u,{type:"primary",onClick:S,loading:g,disabled:s.length===0,children:"បន្ត"})]})]})]})]})}export{Se as default};
