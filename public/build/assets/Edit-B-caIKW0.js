import{r as n,j as t,Q as k,t as u,B as c,h as g,s as p,a as C}from"./app-mk9C7I_N.js";import{A as I}from"./AdminLayout-CSpn-5iP.js";import{S as B}from"./SellerForm-i6Bz75oX.js";import{F as v,B as E}from"./BackImageUpload-CWZmETnT.js";import{d as N}from"./dayjs.min-DI9V4UpH.js";import{B as R}from"./Breadcrumb-Ceo11VVb.js";import{C as F}from"./index-DZTYDYFc.js";import{T}from"./index-DDFZ7dy0.js";import{S as y}from"./index-Bt0eMnk-.js";import{R as $,C as j}from"./row-CPFUowx7.js";import{R as w}from"./ArrowLeftOutlined-cOBH5Dj-.js";import{S as D}from"./index-pKRxIKW4.js";import{R as A}from"./ArrowRightOutlined-BoNy8_6V.js";import"./UserOutlined-Do6ZzMFA.js";import"./index-D66KGu5D.js";import"./index-phC_QXgK.js";import"./EllipsisOutlined-DwAdn_jY.js";import"./PurePanel-Bwrv9FGC.js";import"./InboxOutlined-CDGQXwno.js";import"./khmerDate-iNtMyZoL.js";import"./index-ByQ52J4c.js";import"./index-BiMKBPmP.js";import"./getAllowClear-BGHWSs2V.js";import"./Input-DUxd1TpC.js";import"./useVariants-BUy45nvZ.js";import"./EyeOutlined-CQ17cMyg.js";import"./SearchOutlined-jGh7iI3q.js";import"./EditOutlined-CkdCVUZ6.js";import"./index-CHP0fo2g.js";import"./useIcons-CunuZG3Y.js";import"./CheckOutlined-CeCjh9xi.js";import"./DownOutlined-CUiMnNSy.js";import"./index-BrAkZjxA.js";import"./CalendarOutlined-DHG6L8yA.js";import"./ClockCircleOutlined-DNAvTwIZ.js";import"./SaveOutlined-odoOer7R.js";import"./index-DQt1VCxb.js";import"./addEventListener-KCP_u9m-.js";import"./index-DUw4RcKT.js";import"./DeleteOutlined-CQidAT13.js";import"./FileImageOutlined-CqN5lIwV.js";import"./index-C1ppeYdl.js";import"./DownloadOutlined-mYWFKdPn.js";import"./progress-DvkafPop.js";import"./index-Bckrl1S6.js";import"./index-CYzbL2Oe.js";import"./UploadOutlined-DUu2E3k2.js";const{Title:L,Text:wt}=T,{Step:Q}=y;function U({seller:r,documents:m}){const[i,d]=n.useState(0),[o,f]=n.useState(null),[l,x]=n.useState(null),[M,h]=n.useState(!1);n.useEffect(()=>{m&&m.length>0&&m.forEach(e=>{const s={uid:e.id,name:e.file_name,fileName:e.file_name,url:`/storage/${e.file_path}`,base64:`/storage/${e.file_path}`,isExisting:!0,id:e.id,isDisplay:e.is_display,mimeType:"image/jpeg"};e.is_display?f(s):x(s)})},[m]);const a=[{title:"រូបខាងមុខ",content:"front-image"},{title:"រូបខាងក្រោយ",content:"back-image"},{title:"បញ្ចូលព័ត៌មាន",content:"seller-info"}],b=()=>{if(i===0){if(!o){p.error("សូមផ្ទុកឡើងរូបខាងមុខ");return}}else if(i===1&&!l){p.error("សូមផ្ទុកឡើងរូបខាងក្រោយ");return}d(i+1)},S=()=>{d(i-1)},_=async e=>{h(!0);try{const s={...e,frontImage:o,backImage:l};await C.put(`/api/sellers/${r.id}`,s),p.success("អ្នកលក់ត្រូវបានកែប្រែដោយជោគជ័យ"),g.visit(route("data-entry.sellers.index"))}catch(s){console.error("Error updating seller:",s),p.error("មានបញ្ហាក្នុងការកែប្រែអ្នកលក់")}finally{h(!1)}};return t.jsxs(t.Fragment,{children:[t.jsx(k,{title:"កែប្រែអ្នកលក់"}),t.jsxs("div",{className:"seller-edit",children:[t.jsx(R,{items:[{title:t.jsx(u,{href:route("data-entry.index"),children:"ជ្រើសរើសប្រភេទទិន្នន័យ"})},{title:t.jsx(u,{href:route("data-entry.sellers.index"),children:"បញ្ជីអ្នកលក់"})},{title:"កែប្រែអ្នកលក់"}],className:"mb-6"}),t.jsxs(F,{children:[t.jsx(L,{level:4,className:"khmer-heading mb-6",children:"កែប្រែអ្នកលក់"}),t.jsx(y,{current:i,className:"mb-8",children:a.map(e=>t.jsx(Q,{title:e.title,icon:e.icon},e.title))}),t.jsxs("div",{className:"steps-content mb-6",children:[a[i].content==="front-image"&&t.jsx(v,{category:"seller",frontImage:o,onFrontImageChange:f}),a[i].content==="back-image"&&t.jsx(E,{category:"seller",backImage:l,onBackImageChange:x}),a[i].content==="seller-info"&&t.jsx(B,{onSubmit:_,files:[o,l].filter(Boolean),frontImage:o,initialValues:{name:r.name,sex:r.sex,date_of_birth:r.date_of_birth?N(r.date_of_birth):null,identity_number:r.identity_number,address:r.address,phone_number:r.phone_number}})]}),t.jsx("div",{className:"steps-action",children:t.jsxs($,{justify:"space-between",children:[t.jsx(j,{children:i>0&&t.jsx(c,{icon:t.jsx(w,{}),onClick:S,children:"ត្រឡប់ក្រោយ"})}),t.jsx(j,{children:t.jsxs(D,{children:[t.jsx(c,{onClick:()=>g.visit(route("data-entry.sellers.index")),children:"បោះបង់"}),i<a.length-1&&t.jsx(c,{type:"primary",onClick:b,icon:t.jsx(A,{}),iconPosition:"end",children:i===0?"បន្តទៅរូបខាងក្រោយ":"បន្ទាប់"})]})})]})})]})]})]})}U.layout=r=>t.jsx(I,{title:"កែប្រែអ្នកលក់",children:r});export{U as default};
