import{r as l,j as e,Q as B,t as c,d as m}from"./app-D0OhDuOP.js";import{A as D,B as E}from"./AdminLayout-DfyZC7U7.js";import{C as A,R as Q}from"./index-BXZQm44E.js";import{R as y,C as o}from"./row-Cvvd4www.js";import{T as L}from"./index-DUD5X347.js";import{B as r,T as n}from"./index-XQ9uBlxv.js";import{I as M}from"./index-DyIYvMCA.js";import{R}from"./SearchOutlined-DdbS1Qlk.js";import{S}from"./index-BXlDNFm_.js";import{S as g}from"./index-CpY42lHj.js";import{R as Y}from"./ReloadOutlined-Dtwtuc-j.js";import{F as J}from"./Table-CJMywyvl.js";import{R as K}from"./UserOutlined-Bw1Yg3TV.js";import{T as O}from"./index-DxlGwFBo.js";import{R as v}from"./CheckCircleOutlined-_P5yC29H.js";import{R as T}from"./StopOutlined-EZc5FRiH.js";import{R as V}from"./EyeOutlined-Bk9sN1n5.js";import{R as Z}from"./EditOutlined-BQAB7wjt.js";import{P as w}from"./index-BLwNk9Dd.js";import{R as q}from"./DeleteOutlined-C5fTVnAq.js";import{s as i}from"./index-VXrvBi_7.js";import"./index-BKPGZTnh.js";import"./EllipsisOutlined-BcUT9_x5.js";import"./PurePanel-BrlMViLC.js";import"./index-BoUcoXbW.js";import"./Skeleton-BB1PfEPR.js";import"./CloseOutlined-CSg-7HVH.js";import"./useVariants-VmmnPvRy.js";import"./index-BNYa27A7.js";import"./getAllowClear-7r21EHJH.js";import"./CheckOutlined-C-W3vkf9.js";import"./Input-DIi4XD1o.js";import"./pickAttrs-BMtZpb9Y.js";import"./useIcons-De8HtjeC.js";import"./DownOutlined-BKT6hG3e.js";import"./addEventListener-Dvq9iQDE.js";import"./index-CxyNWzZ_.js";import"./useBubbleLock-Dp5g0NxF.js";import"./index-HowiUfuo.js";import"./Pagination-C28t5-1k.js";import"./index-Bjcdw0HM.js";import"./extendsObject-78o_rR5W.js";import"./FileOutlined-CmtzEeI9.js";import"./FolderOutlined-CsvjmU0T.js";import"./useClosable-rmjEiMr1.js";import"./ExclamationCircleFilled-BuCwC-hN.js";import"./ActionButton-DPI_9ZHB.js";import"./InfoCircleFilled-Csbq1HVY.js";const{Title:G}=L,{Option:I}=S;function Ke({roles:$}){const[C,_]=l.useState($||[]),[k,d]=l.useState(!1),[p,x]=l.useState(""),[h,u]=l.useState(null),a=async(s={})=>{d(!0);try{const t=await m.get("/api/roles",{params:{search:p,status:h,...s}});_(t.data.data||t.data)}catch{i.error("Failed to fetch roles")}finally{d(!1)}},z=async s=>{var t,f;try{await m.delete(`/api/roles/${s}`),i.success("Role deleted successfully"),a()}catch(P){i.error(((f=(t=P.response)==null?void 0:t.data)==null?void 0:f.message)||"Failed to delete role")}},N=async s=>{try{await m.post(`/api/roles/${s}/toggle-status`),i.success("Role status updated successfully"),a()}catch{i.error("Failed to update role status")}},j=()=>{a()},b=()=>{x(""),u(null),a()},F=[{title:"ឈ្មោះតួនាទី",dataIndex:"display_name",key:"display_name",render:(s,t)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s}),e.jsxs("div",{className:"text-gray-500 text-sm",children:["(",t.name,")"]})]})},{title:"ការពិពណ៌នា",dataIndex:"description",key:"description",render:s=>s||"-"},{title:"អ្នកប្រើប្រាស់",dataIndex:"users_count",key:"users_count",render:s=>e.jsx(E,{count:s||0,showZero:!0,children:e.jsx(K,{style:{fontSize:"16px"}})})},{title:"ស្ថានភាព",dataIndex:"is_active",key:"is_active",render:s=>e.jsx(O,{icon:s?e.jsx(v,{}):e.jsx(T,{}),color:s?"success":"error",children:s?"សកម្ម":"អសកម្ម"})},{title:"សកម្មភាព",key:"actions",render:(s,t)=>e.jsxs(g,{size:"small",children:[e.jsx(n,{title:"View Details",children:e.jsx(c,{href:route("roles.show",t.id),children:e.jsx(r,{type:"text",icon:e.jsx(V,{}),size:"small"})})}),e.jsx(n,{title:"Edit Role",children:e.jsx(c,{href:route("roles.edit",t.id),children:e.jsx(r,{type:"text",icon:e.jsx(Z,{}),size:"small"})})}),e.jsx(n,{title:t.is_active?"Deactivate":"Activate",children:e.jsx(w,{title:`Are you sure you want to ${t.is_active?"deactivate":"activate"} this role?`,onConfirm:()=>N(t.id),okText:"Yes",cancelText:"No",children:e.jsx(r,{type:"text",icon:t.is_active?e.jsx(T,{}):e.jsx(v,{}),size:"small",danger:t.is_active})})}),e.jsx(n,{title:"Delete Role",children:e.jsx(w,{title:"Are you sure you want to delete this role?",description:"This action cannot be undone.",onConfirm:()=>z(t.id),okText:"Yes",cancelText:"No",okType:"danger",children:e.jsx(r,{type:"text",icon:e.jsx(q,{}),size:"small",danger:!0,disabled:t.users_count>0})})})]})}];return e.jsxs(D,{title:"Role & Permission Management",children:[e.jsx(B,{title:"Roles & Permissions"}),e.jsxs(A,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(y,{justify:"space-between",align:"middle",className:"mb-4",children:[e.jsx(o,{children:e.jsx(G,{level:4,className:"m-0",children:"តួនាទី និង សិទ្ធិ"})}),e.jsx(o,{children:e.jsx(c,{href:route("roles.create"),children:e.jsx(r,{type:"primary",icon:e.jsx(Q,{}),children:"បង្កើតតួនាទីថ្មី"})})})]}),e.jsxs(y,{gutter:16,className:"mb-4",children:[e.jsx(o,{xs:24,sm:12,md:8,children:e.jsx(M,{placeholder:"ស្វែងរកតួនាទី...",value:p,onChange:s=>x(s.target.value),onPressEnter:j,prefix:e.jsx(R,{})})}),e.jsx(o,{xs:24,sm:12,md:6,children:e.jsxs(S,{placeholder:"ត្រងតាមស្ថានភាព",value:h,onChange:u,allowClear:!0,style:{width:"100%"},children:[e.jsx(I,{value:!0,children:"សកម្ម"}),e.jsx(I,{value:!1,children:"អសកម្ម"})]})}),e.jsx(o,{xs:24,sm:24,md:10,children:e.jsxs(g,{children:[e.jsx(r,{type:"primary",icon:e.jsx(R,{}),onClick:j,children:"ស្វែងរក"}),e.jsx(r,{icon:e.jsx(Y,{}),onClick:b,children:"កំណត់ឡើងវិញ"})]})})]})]}),e.jsx(J,{columns:F,dataSource:C,rowKey:"id",loading:k,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(s,t)=>`${t[0]}-${t[1]} នៃ ${s} តួនាទី`},scroll:{x:800}})]})]})}export{Ke as default};
