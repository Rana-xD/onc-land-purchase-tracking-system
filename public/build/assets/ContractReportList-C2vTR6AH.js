import{r as a,a as w,j as r,Q as g,t as c}from"./app-Cq9T9vxM.js";import{A as C}from"./AdminLayout-CqQNNgQt.js";import{C as L}from"./index-0lybEGve.js";import{T as S}from"./index-B236O7Xl.js";import{S as m}from"./index-B5_NNnDd.js";import{I as b}from"./index-DHD7yk2W.js";import{R as k}from"./SearchOutlined-PK94XR1x.js";import{F as T}from"./Table-BtVi7rN6.js";import{T as I}from"./index-C_oXb-ri.js";import{R as v}from"./EyeOutlined-CFXJhbVH.js";import"./UserOutlined-BJz0bsFe.js";import"./index-DL0uTJIv.js";import"./index-DPFVXnL-.js";import"./EllipsisOutlined-BDh9HHBq.js";import"./PurePanel-Ce8hDmce.js";import"./InboxOutlined-ZSWvT0kT.js";import"./useVariants-Ea3XEG1D.js";import"./EditOutlined-BcDUZ6EU.js";import"./getAllowClear-nqy4kNbo.js";import"./CheckOutlined-_L7buK6x.js";import"./Input-DONKCjvs.js";import"./addEventListener-DU-bjus0.js";import"./index-B3veqm8A.js";import"./useIcons-Ds0_kiqE.js";import"./DownOutlined-8JSIA4HI.js";import"./index-DAepUo0f.js";import"./Pagination-DlQ44rBm.js";import"./index-C_zCuArI.js";import"./FileOutlined-azBO8rMn.js";import"./FolderOutlined-BXGz-0ra.js";const{Title:R}=S;function ie({initialContracts:n}){const[u,p]=a.useState(n||[]),[f,l]=a.useState(!1),[i,x]=a.useState("");a.useEffect(()=>{n||_()},[n]);const _=async()=>{l(!0);try{const e=await w.get("/api/contracts/report-list");p(e.data)}catch(e){console.error("បញ្ហាក្នុងការទាញកិច្ចសន្យា:",e)}finally{l(!1)}},h=e=>e?new Date(e).toLocaleDateString("km-KH",{year:"numeric",month:"long",day:"numeric"}):"",j=u.filter(e=>{if(!i)return!0;const t=i.toLowerCase();return!!(e.document_code&&e.document_code.toLowerCase().includes(t)||e.id.toString().includes(t)||e.document_type&&e.document_type.toLowerCase().includes(t)||e.sellers&&e.sellers.some(o=>o.seller&&o.seller.name&&o.seller.name.toLowerCase().includes(t))||e.lands&&e.lands.some(o=>o.land&&o.land.plot_number&&o.land.plot_number.toLowerCase().includes(t)||o.land&&o.land.location&&o.land.location.toLowerCase().includes(t)))}),y=[{title:"លេខកិច្ចសន្យា",dataIndex:"document_code",key:"document_code",render:(e,t)=>r.jsx(c,{href:d(t),children:r.jsx("span",{className:"text-blue-600 hover:text-blue-800 cursor-pointer",children:e||`#${t.id}`})}),sorter:(e,t)=>e.document_code&&t.document_code?e.document_code.localeCompare(t.document_code):e.id-t.id},{title:"ប្រភេទកិច្ចសន្យា",dataIndex:"document_type",key:"document_type",render:e=>r.jsx(I,{color:e==="deposit_contract"?"blue":"green",children:e==="deposit_contract"?"កិច្ចសន្យាកក់ប្រាក់":"កិច្ចសន្យាលក់ដី"})},{title:"ឈ្មោះអ្នកលក់",key:"sellers",render:(e,t)=>r.jsx("span",{children:t.sellers&&t.sellers.length>0?t.sellers.map(o=>{var s;return(s=o.seller)==null?void 0:s.name}).filter(Boolean).join(", "):"N/A"})},{title:"លេខដីកម្មសិទ្ធិ",key:"lands",render:(e,t)=>r.jsx("span",{children:t.lands&&t.lands.length>0?t.lands.map(o=>{var s;return(s=o.land)==null?void 0:s.plot_number}).filter(Boolean).join(", "):"N/A"})},{title:"តម្លៃសរុប",dataIndex:"total_land_price",key:"total_land_price",render:e=>`$${parseFloat(e||0).toLocaleString()}`,sorter:(e,t)=>(e.total_land_price||0)-(t.total_land_price||0)},{title:"កាលបរិច្ឆេទបង្កើត",dataIndex:"created_at",key:"created_at",render:e=>h(e),sorter:(e,t)=>new Date(e.created_at)-new Date(t.created_at)},{title:"សកម្មភាព",key:"action",render:(e,t)=>r.jsx(m,{size:"small",children:r.jsx(c,{href:d(t),children:r.jsx(v,{className:"text-blue-600 hover:text-blue-800 cursor-pointer"})})})}],d=e=>e.document_type==="deposit_contract"?route("deposit-contracts.success",{id:e.id}):route("sale-contracts.success",{id:e.id});return r.jsxs(C,{children:[r.jsx(g,{title:"របាយការណ៍កិច្ចសន្យា"}),r.jsx("div",{className:"container mx-auto py-6",children:r.jsxs(L,{children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx(R,{level:3,children:"របាយការណ៍កិច្ចសន្យា"}),r.jsx(m,{children:r.jsx(b,{placeholder:"ស្វែងរកកិច្ចសន្យា...",prefix:r.jsx(k,{}),value:i,onChange:e=>x(e.target.value),style:{width:250}})})]}),r.jsx(T,{rowKey:"id",columns:y,dataSource:j,loading:f,pagination:{pageSize:15,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} នៃ ${e} កិច្ចសន្យា`}})]})})]})}export{ie as default};
