import{r as o,j as t,Q as B,B as n,a as u,s as m,h as p}from"./app-BrCXGEhZ.js";import{A as v}from"./AdminLayout-sV_EEP8n.js";import{T as P}from"./index-Dru69ujH.js";import{C as b,R as E}from"./index-DRz4vaHg.js";import{R as F,C as h}from"./row-stCrAj79.js";import{I as A}from"./index-qaS1-amX.js";import{R as D}from"./SearchOutlined-BDCl3y_A.js";import{T as c}from"./index-DXnJKA6M.js";import{F as Q}from"./Table-J9C6Be-7.js";import{B as K}from"./index-DfVfnMMj.js";import{S as L}from"./index-OVY5O9Wo.js";import{R as H}from"./EyeOutlined-CG_zYn54.js";import{R as J}from"./EditOutlined-tdLcT6_z.js";import{P as M}from"./index-C5of6ZWE.js";import{R as N}from"./DeleteOutlined-85Q0A1R5.js";import"./UserOutlined-DgkU0Wia.js";import"./index-DjqfnhJJ.js";import"./EllipsisOutlined-CxDggLKs.js";import"./PurePanel-BBaic0YS.js";import"./InboxOutlined-Qxvmf9ye.js";import"./getAllowClear-CiWMq0gn.js";import"./CheckOutlined-BONIWw9W.js";import"./useVariants-EJywnfb4.js";import"./Input-BbbFc-8M.js";import"./addEventListener-I1XHhjus.js";import"./index-Ch5jzg5Q.js";import"./useIcons-CR98POIW.js";import"./DownOutlined-Bc8ecrXM.js";import"./index-D0979U_2.js";import"./useBubbleLock-CmR5-O3r.js";import"./index-Dib3LoS_.js";import"./Pagination-7ru7OaTS.js";import"./index-DwuA6IHU.js";import"./FileOutlined-DtqVzwrm.js";import"./FolderOutlined-sXfZ_WPD.js";const{Title:U,Text:f}=P;function $t(){const[g,j]=o.useState([]),[y,l]=o.useState(!1),[d,C]=o.useState(""),[x,S]=o.useState({current:1,pageSize:15,total:0}),k=e=>new Intl.NumberFormat("km-KH",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e||0),r=async(e=1,s="")=>{l(!0);try{const i=await u.get("/commissions/api/post-purchase",{params:{page:e,search:s}});i.data.commissions&&(j(i.data.commissions),S({current:i.data.pagination.current_page,pageSize:i.data.pagination.per_page,total:i.data.pagination.total}))}catch{m.error("មានបញ្ហាក្នុងការទាញយកទិន្នន័យ")}finally{l(!1)}};o.useEffect(()=>{r()},[]);const w=e=>{C(e),r(1,e)},T=e=>{r(e.current,d)},R=()=>{p.visit("/commissions/post-purchase/create")},I=e=>{p.visit(`/commissions/post-purchase/${e.id}/edit`)},$=e=>{p.visit(`/commissions/post-purchase/${e.id}/payment-steps`)},_=async e=>{var s,i;try{const a=await u.delete(`/commissions/api/post-purchase/${e}`);a.data.success&&(m.success(a.data.message),r(x.current,d))}catch(a){m.error(((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.message)||"មានបញ្ហាក្នុងការលុប")}},z=[{title:"ឈ្មោះអ្នកទទួល",dataIndex:"recipient_name",key:"recipient_name",render:e=>t.jsx(f,{strong:!0,children:e})},{title:"ចំនួនសរុប",dataIndex:"total_amount",key:"total_amount",align:"right",render:e=>t.jsx(f,{strong:!0,children:k(e)})},{title:"ការពិពណ៌នា",dataIndex:"description",key:"description",render:e=>e||"-"},{title:"ស្ថានភាព",dataIndex:"status",key:"status",align:"center",render:e=>{const s={pending:{status:"warning",text:"មិនទាន់បង់"},partial:{status:"processing",text:"បង់ខ្លះ"},paid:{status:"success",text:"បានបង់ហើយ"}},i=s[e]||s.pending;return t.jsx(K,{status:i.status,text:i.text})}},{title:"សកម្មភាព",key:"actions",align:"center",render:(e,s)=>t.jsxs(L,{children:[t.jsx(c,{title:"មើលជំហានទូទាត់",children:t.jsx(n,{type:"link",icon:t.jsx(H,{}),onClick:()=>$(s),size:"small"})}),t.jsx(c,{title:"កែប្រែកុំស្យុង",children:t.jsx(n,{type:"link",icon:t.jsx(J,{}),onClick:()=>I(s),size:"small"})}),t.jsx(M,{title:"តើអ្នកពិតជាចង់លុបមែនទេ?",onConfirm:()=>_(s.id),okText:"យល់ព្រម",cancelText:"បោះបង់",children:t.jsx(c,{title:"លុបកុំស្យុង",children:t.jsx(n,{type:"link",danger:!0,icon:t.jsx(N,{}),size:"small"})})})]})}];return t.jsxs(v,{children:[t.jsx(B,{title:"កុំស្យុងក្រោយទិញ"}),t.jsxs("div",{style:{padding:"24px"},children:[t.jsx("div",{style:{marginBottom:"24px",textAlign:"center"},children:t.jsx(U,{level:2,style:{margin:0},children:"កុំស្យុងក្រោយទិញ"})}),t.jsxs(b,{children:[t.jsxs(F,{justify:"space-between",align:"middle",style:{marginBottom:"16px"},children:[t.jsx(h,{children:t.jsx(A.Search,{placeholder:"ស្វែងរកតាមឈ្មោះ...",allowClear:!0,onSearch:w,style:{width:300},prefix:t.jsx(D,{})})}),t.jsx(h,{children:t.jsx(c,{title:"បន្ថែមកុំស្យុងក្រោយទិញថ្មី",children:t.jsx(n,{type:"primary",icon:t.jsx(E,{}),onClick:R,children:"បន្ថែមថ្មី"})})})]}),t.jsx(Q,{columns:z,dataSource:g,rowKey:"id",loading:y,pagination:{...x,showSizeChanger:!1,showQuickJumper:!0,showTotal:(e,s)=>`${s[0]}-${s[1]} នៃ ${e} ធាតុ`},onChange:T,locale:{emptyText:"មិនមានទិន្នន័យ"}})]})]})]})}export{$t as default};
