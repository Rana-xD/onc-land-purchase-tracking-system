import{r as f,j as e,Q as T,B as m,h,s as p}from"./app-zwF1qXmt.js";import{A,e as M}from"./AdminLayout-7EiKnzDi.js";import{F as a}from"./index-DXl_YxVc.js";import{C as x}from"./index-BViq9QJ5.js";import{R as c,C as o}from"./row-CL6R5YQg.js";import{T as D}from"./index-Bur7rjdX.js";import{R as q}from"./ArrowLeftOutlined-Tw5MBVrk.js";import{I as j}from"./index-DnWjr1E0.js";import{A as z}from"./index-DiSYeOLK.js";import{C as b}from"./Collapse-Dv2nHD4s.js";import{C as g}from"./index-DZvpsH_A.js";import{S as y}from"./index-Dcqx-5CC.js";import{D as E}from"./index-BoPAxKdL.js";import{R as B}from"./SaveOutlined-eM06Z9ip.js";import"./UserOutlined-_tsZ_L2L.js";import"./index-BwOrOVI4.js";import"./index-B73L-RiE.js";import"./EllipsisOutlined-BgCch_Wi.js";import"./PurePanel-BlgAcrce.js";import"./InboxOutlined-C6Tl-Jce.js";import"./useVariants-DJWLAYkM.js";import"./EditOutlined-DAqDAxHf.js";import"./getAllowClear-DSmRZVga.js";import"./CheckOutlined-CWbPYj3k.js";import"./Input-BkgYjX8b.js";import"./EyeOutlined-DlB_godP.js";import"./SearchOutlined-ckskIcIF.js";import"./useBubbleLock-Be9_HeRQ.js";const{Title:L,Text:C}=D,{TextArea:P}=j,{Panel:Q}=b;function ue({permissions:v}){const[R]=a.useForm(),[S,d]=f.useState(!1),[l,n]=f.useState([]),N=async t=>{d(!0);try{const r={...t,permissions:l};h.post(route("roles.store"),r,{onSuccess:()=>{p.success("Role created successfully")},onError:s=>{p.error("Please check the form for errors")},onFinish:()=>d(!1)})}catch{p.error("Failed to create role"),d(!1)}},k=(t,r)=>{const s=t.map(i=>i.id);n(r?i=>[...new Set([...i,...s])]:i=>i.filter(F=>!s.includes(F)))},w=(t,r)=>{n(r?s=>[...s,t]:s=>s.filter(i=>i!==t))},u=t=>t.every(r=>l.includes(r.id)),I=t=>t.some(r=>l.includes(r.id))&&!u(t),_=t=>({dashboard:"ផ្ទាំងគ្រប់គ្រង",buyers:"គ្រប់គ្រងអ្នកទិញ",sellers:"គ្រប់គ្រងអ្នកលក់",lands:"គ្រប់គ្រងដី",deposit_contracts:"លិខិតកក់ប្រាក់",sale_contracts:"លិខិតទិញលក់",reports:"របាយការណ៍",pre_purchase_commission:"កុំស្យុងមុនទិញ",post_purchase_commission:"កុំស្យុងក្រោយទិញ",users:"គ្រប់គ្រងអ្នកប្រើប្រាស់",roles:"គ្រប់គ្រងតួនាទី",permissions:"គ្រប់គ្រងសិទ្ធិ"})[t]||t.replace("_"," ").replace(/\b\w/g,s=>s.toUpperCase());return e.jsxs(A,{title:"Create New Role",children:[e.jsx(T,{title:"Create Role"}),e.jsxs(x,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs(c,{justify:"space-between",align:"middle",children:[e.jsx(o,{children:e.jsx(L,{level:4,className:"m-0",children:"បង្កើតតួនាទីថ្មី"})}),e.jsx(o,{children:e.jsx(m,{icon:e.jsx(q,{}),onClick:()=>h.visit(route("roles.index")),children:"ត្រលប់ទៅតួនាទី"})})]})}),e.jsxs(a,{form:R,layout:"vertical",onFinish:N,requiredMark:!1,children:[e.jsxs(c,{gutter:24,children:[e.jsx(o,{xs:24,lg:12,children:e.jsxs(x,{title:"ព័ត៌មានមូលដ្ឋាន",size:"small",children:[e.jsx(a.Item,{label:"ឈ្មោះតួនាទី",name:"name",rules:[{required:!0,message:"សូមបញ្ចូលឈ្មោះតួនាទី"},{max:255,message:"ឈ្មោះតួនាទីត្រូវតែតិចជាង 255 តួអក្សរ"}],children:e.jsx(j,{placeholder:"ឧ: manager, staff, viewer"})}),e.jsx(a.Item,{label:"ឈ្មោះបង្ហាញ",name:"display_name",rules:[{required:!0,message:"សូមបញ្ចូលឈ្មោះបង្ហាញ"},{max:255,message:"ឈ្មោះបង្ហាញត្រូវតែតិចជាង 255 តួអក្សរ"}],children:e.jsx(j,{placeholder:"ឧ: អ្នកគ្រប់គ្រង, បុគ្គលិក, អ្នកមើល"})}),e.jsx(a.Item,{label:"ការពិពណ៌នា",name:"description",children:e.jsx(P,{rows:4,placeholder:"ពិពណ៌នាអំពីតួនាទី និងការទទួលខុសត្រូវ..."})})]})}),e.jsx(o,{xs:24,lg:12,children:e.jsxs(x,{title:e.jsxs(y,{children:[e.jsx(M,{}),e.jsxs("span",{children:["សិទ្ធិ (",l.length," បានជ្រើសរើស)"]})]}),size:"small",children:[e.jsx(z,{message:"ជ្រើសរើសសិទ្ធិដែលតួនាទីនេះគួរមាន",description:"អ្នកប្រើប្រាស់ដែលត្រូវបានកំណត់ឱ្យតួនាទីនេះនឹងទទួលបានសិទ្ធិទាំងនេះ។",type:"info",showIcon:!0,className:"mb-4"}),e.jsx(b,{size:"small",ghost:!0,children:Object.entries(v||{}).map(([t,r])=>e.jsx(Q,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{checked:u(r),indeterminate:I(r),onChange:s=>k(r,s.target.checked),onClick:s=>s.stopPropagation(),children:e.jsx(C,{strong:!0,children:_(t)})}),e.jsxs(C,{type:"secondary",children:[r.filter(s=>l.includes(s.id)).length,"/",r.length]})]}),children:e.jsx("div",{className:"pl-6",children:e.jsx(c,{gutter:[16,8],children:r.map(s=>e.jsx(o,{xs:24,sm:12,children:e.jsx(g,{checked:l.includes(s.id),onChange:i=>w(s.id,i.target.checked),children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.display_name}),s.description&&e.jsx("div",{className:"text-xs text-gray-500",children:s.description})]})})},s.id))})})},t))})]})})]}),e.jsx(E,{}),e.jsx(c,{justify:"end",children:e.jsx(o,{children:e.jsxs(y,{children:[e.jsx(m,{onClick:()=>h.visit(route("roles.index")),children:"បោះបង់"}),e.jsx(m,{type:"primary",htmlType:"submit",loading:S,icon:e.jsx(B,{}),children:"បង្កើតតួនាទី"})]})})})]})]})]})}export{ue as default};
