import{r as j,j as e,Q as v,B as n,h as f,s as p}from"./app-mk9C7I_N.js";import{A as I}from"./AdminLayout-CSpn-5iP.js";import{F as i}from"./index-ByQ52J4c.js";import{C as S}from"./index-DZTYDYFc.js";import{T as $}from"./index-DDFZ7dy0.js";import{R as F}from"./ArrowLeftOutlined-cOBH5Dj-.js";import{R as c,C as o}from"./row-CPFUowx7.js";import{T as g}from"./index-CuozxnK8.js";import{I as L}from"./index-BiMKBPmP.js";import{D as O}from"./index-DDZo9mtM.js";import{S as l}from"./index-CHP0fo2g.js";import{S as R}from"./index-pKRxIKW4.js";import{R as q}from"./SaveOutlined-odoOer7R.js";import"./UserOutlined-Do6ZzMFA.js";import"./index-D66KGu5D.js";import"./index-phC_QXgK.js";import"./EllipsisOutlined-DwAdn_jY.js";import"./PurePanel-Bwrv9FGC.js";import"./InboxOutlined-CDGQXwno.js";import"./useVariants-BUy45nvZ.js";import"./EditOutlined-CkdCVUZ6.js";import"./getAllowClear-BGHWSs2V.js";import"./CheckOutlined-CeCjh9xi.js";import"./DownOutlined-CUiMnNSy.js";import"./Input-DUxd1TpC.js";import"./EyeOutlined-CQ17cMyg.js";import"./SearchOutlined-jGh7iI3q.js";import"./useIcons-CunuZG3Y.js";const{Title:E}=$,{Option:h}=l;function de({document:t,buyers:y,sellers:b,lands:_}){const[d]=i.useForm(),[w,m]=j.useState(!1);j.useEffect(()=>{var r,s,x;d.setFieldsValue({total_land_price:parseFloat(t.total_land_price)||void 0,deposit_amount:parseFloat(t.deposit_amount)||void 0,deposit_months:t.deposit_months,buyers:((r=t.buyers)==null?void 0:r.map(a=>a.buyer_id))||[],sellers:((s=t.sellers)==null?void 0:s.map(a=>a.seller_id))||[],lands:((x=t.lands)==null?void 0:x.map(a=>a.land_id))||[]})},[t,d]);const C=async r=>{m(!0);try{f.put(route("deposit-contracts.update",{id:t.id}),r,{onSuccess:()=>{p.success("លិខិតកក់ប្រាក់ត្រូវបានកែសម្រួលដោយជោគជ័យ")},onError:s=>{console.error("Validation errors:",s),p.error("មានបញ្ហាក្នុងការកែសម្រួល")},onFinish:()=>{m(!1)}})}catch(s){console.error("Error updating deposit contract:",s),p.error("មានបញ្ហាក្នុងការកែសម្រួល"),m(!1)}},u=()=>{f.visit(route("deposit-contracts.index"))};return e.jsxs(I,{children:[e.jsx(v,{title:"កែសម្រួលលិខិតកក់ប្រាក់"}),e.jsx("div",{className:"container mx-auto py-6",children:e.jsxs(S,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs(E,{level:3,children:["កែសម្រួលលិខិតកក់ប្រាក់ #",t.id]}),e.jsx(n,{icon:e.jsx(F,{}),onClick:u,children:"ត្រឡប់ក្រោយ"})]}),e.jsxs(i,{form:d,layout:"vertical",onFinish:C,size:"large",children:[e.jsxs(c,{gutter:24,children:[e.jsx(o,{xs:24,md:12,children:e.jsx(i.Item,{label:"តម្លៃដីសរុប ($)",name:"total_land_price",rules:[{required:!0,message:"សូមបញ្ចូលតម្លៃដីសរុប"},{type:"number",min:.01,message:"តម្លៃត្រូវតែធំជាង 0"}],children:e.jsx(g,{style:{width:"100%"},formatter:r=>`$ ${r}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:r=>r.replace(/\$\s?|(,*)/g,""),placeholder:"បញ្ចូលតម្លៃដីសរុប"})})}),e.jsx(o,{xs:24,md:12,children:e.jsx(i.Item,{label:"ចំនួនប្រាក់កក់ ($)",name:"deposit_amount",rules:[{required:!0,message:"សូមបញ្ចូលចំនួនប្រាក់កក់"},{type:"number",min:.01,message:"ចំនួនប្រាក់កក់ត្រូវតែធំជាង 0"}],children:e.jsx(g,{style:{width:"100%"},formatter:r=>`$ ${r}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:r=>r.replace(/\$\s?|(,*)/g,""),placeholder:"បញ្ចូលចំនួនប្រាក់កក់"})})})]}),e.jsx(c,{gutter:24,children:e.jsx(o,{xs:24,md:12,children:e.jsx(i.Item,{label:"រយៈពេលកក់ប្រាក់",name:"deposit_months",rules:[{required:!0,message:"សូមបញ្ចូលរយៈពេលកក់ប្រាក់"}],children:e.jsx(L,{placeholder:"ឧ. 3 ខែ, 2 សប្តាហ៍, 10 ថ្ងៃ"})})})}),e.jsx(O,{}),e.jsxs(c,{gutter:24,children:[e.jsx(o,{xs:24,md:8,children:e.jsx(i.Item,{label:"អ្នកទិញ",name:"buyers",rules:[{required:!0,message:"សូមជ្រើសរើសអ្នកទិញ"}],children:e.jsx(l,{mode:"multiple",placeholder:"ជ្រើសរើសអ្នកទិញ",showSearch:!0,filterOption:(r,s)=>s.children.toLowerCase().indexOf(r.toLowerCase())>=0,children:y.map(r=>e.jsx(h,{value:r.id,children:r.name},r.id))})})}),e.jsx(o,{xs:24,md:8,children:e.jsx(i.Item,{label:"អ្នកលក់",name:"sellers",rules:[{required:!0,message:"សូមជ្រើសរើសអ្នកលក់"}],children:e.jsx(l,{mode:"multiple",placeholder:"ជ្រើសរើសអ្នកលក់",showSearch:!0,filterOption:(r,s)=>s.children.toLowerCase().indexOf(r.toLowerCase())>=0,children:b.map(r=>e.jsx(h,{value:r.id,children:r.name},r.id))})})}),e.jsx(o,{xs:24,md:8,children:e.jsx(i.Item,{label:"ដីធ្លី",name:"lands",rules:[{required:!0,message:"សូមជ្រើសរើសដីធ្លី"}],children:e.jsx(l,{mode:"multiple",placeholder:"ជ្រើសរើសដីធ្លី",showSearch:!0,filterOption:(r,s)=>s.children.toLowerCase().indexOf(r.toLowerCase())>=0,children:_.map(r=>e.jsxs(h,{value:r.id,children:[r.plot_number," - ",r.location]},r.id))})})})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs(R,{children:[e.jsx(n,{onClick:u,children:"បោះបង់"}),e.jsx(n,{type:"primary",htmlType:"submit",loading:w,icon:e.jsx(q,{}),children:"រក្សាទុកការកែប្រែ"})]})})]})]})})]})}export{de as default};
