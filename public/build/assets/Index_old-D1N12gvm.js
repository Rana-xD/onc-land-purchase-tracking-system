import{r as n,j as e,Q as C,a as b,s as w}from"./app-Cq9T9vxM.js";import{A as L}from"./AdminLayout-CqQNNgQt.js";import{T as E}from"./index-B236O7Xl.js";import{I as G}from"./index-DHD7yk2W.js";import"./UserOutlined-BJz0bsFe.js";import"./index-DL0uTJIv.js";import"./index-DPFVXnL-.js";import"./EllipsisOutlined-BDh9HHBq.js";import"./PurePanel-Ce8hDmce.js";import"./index-B5_NNnDd.js";import"./InboxOutlined-ZSWvT0kT.js";import"./EditOutlined-BcDUZ6EU.js";import"./getAllowClear-nqy4kNbo.js";import"./useVariants-Ea3XEG1D.js";import"./CheckOutlined-_L7buK6x.js";import"./Input-DONKCjvs.js";import"./EyeOutlined-CFXJhbVH.js";import"./SearchOutlined-PK94XR1x.js";const{Title:ee}=E,{Search:se}=G;function te({auth:v,statistics:l,archived:_}){var p,u,h,y,g,j,f,N;const[T,o]=n.useState(!1),[r,k]=n.useState(_||{}),[c,I]=n.useState(""),[D,S]=n.useState("1"),$=async(s,t)=>{try{o(!0),await b.post("/archive/restore",{type:s,id:t}),w.success("ទិន្នន័យត្រូវបានស្តារដោយជោគជ័យ");const a=await b.get("/archive/type/"+s);k(i=>({...i,[s]:a.data}))}catch(a){console.error("Error restoring:",a),w.error("មានបញ្ហាក្នុងការស្តារទិន្នន័យ")}finally{o(!1)}},d=s=>{if(s==="all")return Object.entries(r).flatMap(([t,a])=>a.map(i=>({...i,type:t})));switch(s){case"data_entry":return[...(r.buyers||[]).map(t=>({...t,type:"buyers",typeName:"អ្នកទិញ"})),...(r.sellers||[]).map(t=>({...t,type:"sellers",typeName:"អ្នកលក់"})),...(r.lands||[]).map(t=>({...t,type:"lands",typeName:"ដី"}))];case"contracts":return[...(r.document_creations||[]).map(t=>({...t,type:"document_creations",typeName:"ឯកសារបង្កើត"})),...(r.sale_contracts||[]).map(t=>({...t,type:"sale_contracts",typeName:"កិច្ចសន្យាលក់"}))];case"commissions":return(r.commissions||[]).map(t=>({...t,type:"commissions",typeName:"កុំស្យុង"}));case"users":return[...(r.users||[]).map(t=>({...t,type:"users",typeName:"អ្នកប្រើប្រាស់"})),...(r.roles||[]).map(t=>({...t,type:"roles",typeName:"តួនាទី"}))];default:return[]}},A=s=>s?new Date(s).toLocaleDateString("km-KH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"គ្មាន",x=s=>s.name?s.name:s.title?s.title:s.land_title_number?`ដីលេខ: ${s.land_title_number}`:s.contract_number?`កិច្ចសន្យាលេខ: ${s.contract_number}`:s.commission_type?`កុំស្យុង ${s.commission_type}`:`#${s.id}`,m=s=>c?s.filter(t=>x(t).toLowerCase().includes(c.toLowerCase())):s;return e.jsxs(L,{user:v.user,children:[e.jsx(C,{title:"ទិន្នន័យ"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ArchiveBoxIcon,{className:"h-8 w-8 text-gray-600 mr-3"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"ទិន្នន័យ"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"ស្វែងរក...",value:c,onChange:s=>I(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),e.jsx(MagnifyingGlassIcon,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-600",children:"ទិន្នន័យបញ្ចូល"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(((p=l.data_entry)==null?void 0:p.buyers)||0)+(((u=l.data_entry)==null?void 0:u.sellers)||0)+(((h=l.data_entry)==null?void 0:h.lands)||0)})]}),e.jsx(DocumentTextIcon,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600",children:"កិច្ចសន្យា"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:(((y=l.contracts)==null?void 0:y.document_creations)||0)+(((g=l.contracts)==null?void 0:g.sale_contracts)||0)})]}),e.jsx(DocumentTextIcon,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-600",children:"កុំស្យុង"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:((j=l.commissions)==null?void 0:j.total)||0})]}),e.jsx(CurrencyDollarIcon,{className:"h-8 w-8 text-yellow-500"})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-600",children:"អ្នកប្រើប្រាស់"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(((f=l.users)==null?void 0:f.users)||0)+(((N=l.users)==null?void 0:N.roles)||0)})]}),e.jsx(UserGroupIcon,{className:"h-8 w-8 text-purple-500"})]})})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:e.jsxs(Tab.Group,{selectedIndex:D,onChange:S,children:[e.jsx(Tab.List,{className:"flex space-x-1 rounded-t-lg bg-gray-100 p-1",children:tabs.map(s=>e.jsx(Tab,{className:({selected:t})=>`w-full rounded-lg py-2.5 text-sm font-medium leading-5 transition-colors
                                            ${t?"bg-white text-blue-700 shadow":"text-gray-700 hover:bg-white/[0.12] hover:text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(s.icon,{className:"h-5 w-5 mr-2"}),s.name]})},s.key))}),e.jsx(Tab.Panels,{className:"p-6",children:tabs.map(s=>e.jsx(Tab.Panel,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ប្រភេទ"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ឈ្មោះ/លេខសម្គាល់"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"កាលបរិច្ឆេទលុប"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"លុបដោយ"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"សកម្មភាព"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[m(d(s.key)).map(t=>{var a;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.typeName||t.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:x(t)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A(t.deleted_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((a=t.deleted_by)==null?void 0:a.name)||"មិនស្គាល់"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("button",{onClick:()=>$(t.type,t.id),disabled:T,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",children:[e.jsx(ArrowPathIcon,{className:"h-4 w-4 mr-1"}),"ស្ដារឡើងវិញ"]})})]},`${t.type}-${t.id}`)}),m(d(s.key)).length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"មិនមានទិន្នន័យក្នុងទិន្នន័យ"})})]})]})})},s.key))})]})})]})})]})}export{te as default};
