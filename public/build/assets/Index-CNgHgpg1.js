import{r as l,j as e,Q as B,t as S,B as u,h as g,a as j,s as f}from"./app-zwF1qXmt.js";import{A as D}from"./AdminLayout-7EiKnzDi.js";import{B as E}from"./Breadcrumb-BndVQP3H.js";import{C as L,R as N}from"./index-BViq9QJ5.js";import{R as F,C as y}from"./row-CL6R5YQg.js";import{T as P}from"./index-Bur7rjdX.js";import{S as z}from"./index-Dcqx-5CC.js";import{I as v}from"./index-DnWjr1E0.js";import{R as A}from"./SearchOutlined-ckskIcIF.js";import{T as h}from"./index-B73L-RiE.js";import{F as O}from"./Table-BOxY9eJ4.js";import{R as Q}from"./EditOutlined-DAqDAxHf.js";import{P as q}from"./index-Bym_9FdC.js";import{R as K}from"./DeleteOutlined-CSBNabzb.js";import"./UserOutlined-_tsZ_L2L.js";import"./index-BwOrOVI4.js";import"./EllipsisOutlined-BgCch_Wi.js";import"./PurePanel-BlgAcrce.js";import"./InboxOutlined-C6Tl-Jce.js";import"./DownOutlined-CAWJwJ4J.js";import"./useVariants-DJWLAYkM.js";import"./getAllowClear-DSmRZVga.js";import"./CheckOutlined-CWbPYj3k.js";import"./Input-BkgYjX8b.js";import"./EyeOutlined-DlB_godP.js";import"./addEventListener-VTVT0Xmn.js";import"./index-CseKHSuS.js";import"./useIcons-DF0NetuM.js";import"./index-DZvpsH_A.js";import"./useBubbleLock-Be9_HeRQ.js";import"./index-c65RzQeC.js";import"./Pagination-a66s3alc.js";import"./index-lwJ32dcB.js";import"./FileOutlined-Cr8DQwSN.js";import"./FolderOutlined-D2Qk_bz3.js";const{Title:M}=P;function U({lands:s,pagination:i}){const[I,c]=l.useState(!1),[x,T]=l.useState(""),[w,d]=l.useState([]),[a,m]=l.useState({current:1,pageSize:10,total:0});l.useEffect(()=>{s&&d(s),i&&m({current:i.current_page,pageSize:i.per_page,total:i.total})},[s,i]);const C=t=>{T(t),p(1,a.pageSize,t)},R=t=>{m(r=>({...r,current:t.current,pageSize:t.pageSize})),p(t.current,t.pageSize,x)},p=async(t,r,$="")=>{c(!0);try{const n=r||a.pageSize||10,o=await j.get("/api/lands",{params:{page:t,per_page:n,search:$}});o.data&&o.data.data?d(o.data.data):d([]),o.data&&o.data.meta?m({current:o.data.meta.current_page||1,pageSize:n,total:o.data.meta.total||0}):m({current:1,pageSize:n,total:0})}catch(n){console.error("Error fetching lands:",n),f.error("មានបញ្ហាក្នុងការទាញយកទិន្នន័យដី"),d([])}finally{c(!1)}},_=async t=>{c(!0);try{await j.delete(`/api/lands/${t}`),f.success("បានលុបទិន្នន័យដីដោយជោគជ័យ"),p(a.current,a.pageSize,x)}catch(r){console.error("Error deleting land:",r),f.error("មានបញ្ហាក្នុងការលុបទិន្នន័យដី")}finally{c(!1)}},b=t=>`${Number(t).toLocaleString("en-US",{maximumFractionDigits:2})} ម²`,k=[{title:"លេខក្បាលដី",dataIndex:"plot_number",key:"plot_number",render:(t,r)=>e.jsx(S,{href:route("data-entry.lands.show",r.id),children:t})},{title:"ទំហំ",dataIndex:"size",key:"size",render:t=>b(t)},{title:"ទីតាំង",dataIndex:"location",key:"location",ellipsis:!0},{title:"កាលបរិច្ឆេទចុះបញ្ជី",dataIndex:"date_of_registration",key:"date_of_registration",render:t=>t?new Date(t).toISOString().split("T")[0]:""},{title:"សកម្មភាព",key:"action",render:(t,r)=>e.jsxs(z,{size:"small",children:[e.jsx(h,{title:"កែប្រែព័ត៌មានដី",children:e.jsx(u,{type:"default",icon:e.jsx(Q,{}),size:"small",onClick:()=>g.visit(route("data-entry.lands.edit",r.id))})}),e.jsx(q,{title:"តើអ្នកពិតជាចង់លុបទិន្នន័យនេះមែនទេ?",onConfirm:()=>_(r.id),okText:"យល់ព្រម",cancelText:"បោះបង់",children:e.jsx(h,{title:"លុបព័ត៌មានដី",children:e.jsx(u,{type:"default",danger:!0,icon:e.jsx(K,{}),size:"small"})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"បញ្ជីដី"}),e.jsxs("div",{className:"lands-list",children:[e.jsx(E,{items:[{title:e.jsx(S,{href:route("data-entry.index"),children:"ជ្រើសរើសប្រភេទទិន្នន័យ"})},{title:"បញ្ជីដី"}],className:"mb-6"}),e.jsxs(L,{children:[e.jsxs(F,{justify:"space-between",align:"middle",className:"mb-4",children:[e.jsx(y,{children:e.jsx(M,{level:4,className:"khmer-heading m-0",children:"បញ្ជីដី"})}),e.jsx(y,{children:e.jsxs(z,{children:[e.jsx(v.Search,{placeholder:"ស្វែងរក...",allowClear:!0,enterButton:e.jsx(A,{}),onSearch:C,style:{width:250}}),e.jsx(h,{title:"បន្ថែមដីថ្មី",children:e.jsx(u,{type:"primary",icon:e.jsx(N,{}),onClick:()=>g.visit(route("data-entry.lands.create")),children:"បន្ថែមថ្មី"})})]})})]}),e.jsx(O,{columns:k,dataSource:w,rowKey:"id",loading:I,pagination:{current:a.current,pageSize:a.pageSize,total:a.total,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:(t,r)=>`${r[0]}-${r[1]} នៃ ${t} ធាតុ`},onChange:R})]})]})]})}U.layout=s=>e.jsx(D,{title:"បញ្ជីដី",children:s});export{U as default};
